var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o["throw"](t))}catch(e){r(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,r&&(a=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,r=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(o){n=[6,o],r=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,r,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Transform=function(){function t(){this._scalex=1,this._scaley=1,this.Childs=[],this.DisplayobjChilds=[]}return t.prototype.SetParent=function(t){this.Parent&&this.Parent.RemoveChild(this),this.Parent=t,this.Parent.AddChild(this)},t.prototype.AddChild=function(t){this.RemoveChild(t),this.Childs.push(t)},t.prototype.RemoveChild=function(t){Help.ArrayRemove(this.Childs,t)},t.prototype.SetPos=function(t,e){this._x=t,this._y=e},t.prototype.ReSetPos=function(){this.SetPos(this._x,this._y)},t}();__reflect(Transform.prototype,"Transform");var SingletonFactory=function(){function t(){}return t.InstanceT=function(e){var n=e.toString(),o=t.map[n];return o||(o=new e,t.map[n]=o),o},t.Instance=function(e){var n=e.toString(),o=t.map[n];return o||(o=new e,t.map[n]=o),o},t.map={},t}();__reflect(SingletonFactory.prototype,"SingletonFactory");var CallObj=function(){function t(t,e){this.mCall=t,this.mCaller=e}return t.prototype.Invoke=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(n=this.mCall).call.apply(n,[this.mCaller].concat(t));var n},t.prototype.Clear=function(){this.mCall=null,this.mCaller=null},t}();__reflect(CallObj.prototype,"CallObj");var FunctionArry=function(){function t(){this.mCalls=new Array}return t.prototype.Add=function(t){this.mCalls.push(t)},t.prototype.Invoke=function(){for(var t=this.mCalls.length,e=this.mCalls,n=0;t>n;n++)e[n]()},t.prototype.InvokeAndClear=function(){this.Invoke(),this.mCalls=[]},t}();__reflect(FunctionArry.prototype,"FunctionArry");var Signa=function(){function t(){this.mCalls=[],this.mWaitToDo=new FunctionArry}return t.prototype.AddListen=function(t,e){var n=this;return this.mIsSendIng?this.mWaitToDo.Add(function(){n.AddListen(t,e)}):(this.callRemove(t,e),this.mCalls.push(new CallObj(t,e))),this.SetRemoveCall(t,e)},t.prototype.callRemove=function(t,e){for(var n=this.mCalls.length-1;n>=0;n--){var o=this.mCalls[n];if(o.mCaller==e&&o.mCall==t){this.mCalls[n].Clear(),this.mCalls.splice(n,1);break}}},t.prototype.SetCall=function(t,e){return null!=this.OnCall&&this.OnCall.Clear(),null==t?void(this.OnCall=null):void(this.OnCall=new CallObj(t,e))},t.prototype.SetRemoveCall=function(t,e){var n=this,o=function(){n.RemoveListen(t,e)};return o},t.prototype.RemoveListen=function(t,e){var n=this;this.mIsSendIng?this.mWaitToDo.Add(function(){n.RemoveListen(t,e)}):this.callRemove(t,e)},t.prototype.Send=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.mIsSendIng=!0;for(var n=this.mCalls.length,o=this.mCalls,i=0;n>i;i++)(r=o[i]).Invoke.apply(r,t);this.OnCall&&(a=this.OnCall).Invoke.apply(a,t),this.mIsSendIng=!1,this.WaiToDo();var r,a},t.prototype.Get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.mIsSendIng=!0;for(var n=null,o=this.mCalls.length,i=this.mCalls,r=0;o>r;r++)n=i[r].Invoke();return this.OnCall&&(n=(a=this.OnCall).Invoke.apply(a,t)),this.mIsSendIng=!1,this.WaiToDo(),n;var a},t.prototype.WaiToDo=function(){this.mWaitToDo.InvokeAndClear()},t.prototype.Clear=function(){this.mCalls=[],this.OnCall=void 0},t.prototype.isClear=function(){return!this.OnCall&&0==this.mCalls.length},t}();__reflect(Signa.prototype,"Signa");var SignaManger=function(){function t(){this.mapC={},this.mapID=[],this.mapO={},this.AllIDNum=0,this.UseIDnum=0,this.UpdateID()}return t.prototype.One=function(t){var e=t.toString(),n=this.mapC[e];return n||(n=new t,this.mapC[e]=n),n},t.prototype.UpdateID=function(){if(this.UseIDnum==this.AllIDNum){this.AllIDNum+=1e4;for(var t=this.mapID,e=this.AllIDNum-1;e>=this.UseIDnum;e--)t.push(e)}},t.prototype.GetID=function(){return this.UpdateID(),this.UseIDnum++,this.mapID.pop()},t.prototype.Get=function(t,e){var n=t.toString(),o=this.mapO[n];void 0===o&&(o={}),void 0===e.SID&&(e.SID=this.GetID());var i=o[e.SID];return void 0===i&&(i=new t,o[e.SID]=i),i},t.prototype.Clear=function(){var t=this.mapC;for(var e in t)t[e].Clear();this.mapC={};var n=this.mapO;for(var e in n){var o=n[e];for(var i in o)o[i].Clear();n[e]={}}this.mapO={}},t.Instance=new t,t}();__reflect(SignaManger.prototype,"SignaManger",["SignaClear"]);var GetSigna=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Call=function(){return this.Get()},e}(Signa);__reflect(GetSigna.prototype,"GetSigna",["GetFun"]);var SetSigna=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Call=function(t){return this.Send(t)},e}(Signa);__reflect(SetSigna.prototype,"SetSigna");var MyUpateObj=function(){function t(t){this.onUpdata=new Signa,this._obj=t}return t.prototype.set=function(t){this._obj=t,this.Send()},t.prototype.get=function(){return this._obj},Object.defineProperty(t.prototype,"Obj",{get:function(){return this._obj},set:function(t){this._obj=t,this.Send()},enumerable:!0,configurable:!0}),t.prototype.Send=function(){this.onUpdata.Send(this._obj)},t.prototype.Clear=function(){this.onUpdata.Clear()},t}();__reflect(MyUpateObj.prototype,"MyUpateObj",["SignaClear","IMyUpateObj"]);var LoopObjNew=function(){function t(){this._data=[],this._noUseNum=0,this._length=0}return t.prototype.Init=function(t){this._default=t,this.Add(t)},t.prototype.Add=function(t){this._data.push(t),t.Id=this._length,this._noUseNum+=1,this._length+=1},t.prototype.Get=function(){0==this._noUseNum&&(this.Add(this._default.Clone()),this.change(this._length-1,0)),this._noUseNum--;var t=this._data[this._noUseNum];return t.IsUse=!0,t},t.prototype.change=function(t,e){var n=this._data[t],o=this._data[e];n.Id=e,o.Id=t,this._data[t]=o,this._data[e]=n},t.prototype.ClearAll=function(){if(this._noUseNum!=this._length){for(var t=this._data.length-1;t>0;t--)this._data[t].IsUse=!1,this._data[t].Recovery();this._noUseNum=this._length}},t.prototype.RecoveryOne=function(t){t.IsUse&&(this.change(t.Id,this._noUseNum),this._noUseNum++,t.IsUse=!1)},t}();__reflect(LoopObjNew.prototype,"LoopObjNew",["ILoopObj"]);var Gameobject=function(t){function e(){var e=t.call(this)||this;return e.cx=0,e.cy=0,e._camear=null,e._camear=GameCameraSingle.Interest.SceneCamera.get(),e._camear?e.SetParent(e._camear):GameCameraSingle.Interest.SceneCamera.onUpdata.AddListen(function(t){e._camear=t,e.SetParent(e._camear)},e),e}return __extends(e,t),e.prototype.SetPos=function(t,e){this._x=t,this._y=e,this.cx=t-this._camear._x+this._camear.EgretX,this.cy=e-this._camear._y+this._camear.EgretY;for(var n=0,o=this.DisplayobjChilds;n<o.length;n++){var i=o[n];i.SetPos(this.cx,this.cy)}},e.prototype.SetScale=function(t,e){this._scalex=t,this._scaley=e;for(var n=0,o=this.DisplayobjChilds;n<o.length;n++){var i=o[n];i.SetScale(t,e)}},e}(Transform);__reflect(Gameobject.prototype,"Gameobject");var FaceBookPlatform=function(){function t(){}return t.prototype.getContext=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,FBInstant.context]})})},t.prototype.initSdk=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return"undefined"==typeof FBInstant?[2]:(this.initializeAsync(t),[2])})})},t.prototype.getEntryPointData=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t=FBInstant.getEntryPointData(),[2,t]})})},t.prototype.chooseAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return-1==FBInstant.getSupportedAPIs().indexOf("context.chooseAsync")?(t.fail(),[2]):(FBInstant.context.chooseAsync({filter:["NEW_CONTEXT_ONLY"],minSize:2,maxSize:4}).then(function(){t.success()})["catch"](function(e){t.fail(e)}),[2])})})},t.prototype.updateAsync=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){return-1==FBInstant.getSupportedAPIs().indexOf("updateAsync")?(t.fail(),[2]):(t.payload&&"CUSTOM"==t.payload.action&&(e=this,FBInstant.updateAsync(t.payload).then(function(){t.success()})["catch"](function(e){t.fail(e)})),[2])})})},t.prototype.setLoadingProgress=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return"undefined"==typeof FBInstant?[2]:(FBInstant.setLoadingProgress(100*t),[2])})})},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return"undefined"==typeof FBInstant?[2,{nickName:"昵称"}]:[2,FBInstant.player]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.quit=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return FBInstant.quit(),[2]})})},t.prototype.share=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){return e=FBInstant.player.getName(),FBInstant.shareAsync({intent:t.intent,image:t.imgurl,text:t.title,data:t.data}).then(function(){console.log("share success"),t.complete()}),[2]})})},t.prototype.initializeAsync=function(t){"undefined"!=typeof FBInstant&&FBInstant.initializeAsync().then(function(){console.log("getLocale:",FBInstant.getLocale()),console.log("getPlatform:",FBInstant.getPlatform()),console.log("getSDKVersion",FBInstant.getSDKVersion()),console.log("getSupportedAPIs",FBInstant.getSupportedAPIs()),console.log("getEntryPointData",FBInstant.getEntryPointData()),FBInstant.startGameAsync().then(function(){t.success()})["catch"](function(e){t.fail(e)})})["catch"](function(t){console.info(t)})},t.prototype.getRankData=function(t,e){var n=[];return e?(FBInstant.getLeaderboardAsync(t).then(function(t){t.getConnectedPlayerEntriesAsync(15,0).then(function(t){for(var e=0;10>e;e++){n[e].rank=t[e].getRank(),n[e].score=t[e].getScore();var o=t[e].getPlayer();n[e].name=o.getName(),n[e].icon=o.getPhoto()}})}),n):(FBInstant.getLeaderboardAsync(t).then(function(t){t.getEntriesAsync(15,0).then(function(t){for(var e=0;10>e;e++){n[e].rank=t[e].getRank(),n[e].score=t[e].getScore();var o=t[e].getPlayer();n[e].name=o.getName(),n[e].icon=o.getPhoto()}})}),n)},t}();__reflect(FaceBookPlatform.prototype,"FaceBookPlatform",["Platform"]);var UIWindow=function(t){function e(e){var n=t.call(this)||this;return n._name="",n._name=e,n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRelease,n),n.onInit(),n}return __extends(e,t),e.prototype.getName=function(){return this._name},e.prototype.release=function(){this.onRelease()},e.prototype.onInit=function(){console.log("onInit:",this._name)},e.prototype.onRelease=function(){console.log("onRelease")},e.prototype.close=function(){""!=this._name&&UIManager.instance().closeWindow(this._name)},e}(eui.Component);__reflect(UIWindow.prototype,"UIWindow");var ProtoBase=function(){function t(){}return t.prototype.handleProtocol=function(t){if(1!==t.ret){Logger.warn(ErrorLang[t.ret]);var e=this["fail"+t.pt];return void(e?e.call(this,t):Logger.warn("失败消息解析错误"))}var n=this["handle"+t.pt];n?n.call(this,t):Logger.warn("成功消息解析错误")},t}();__reflect(ProtoBase.prototype,"ProtoBase");var CsvBaseManager=function(){function t(){this.mListCsv=new Array,this.mDictionaryCsv={},this.onLoad()}return t.prototype.onLoad=function(){this.DoLoad(this.ConfigName())},t.prototype.DoLoad=function(t){var e=RES.getRes(t),n=e.split("\r\n");this.UpdateValues(n)},t.prototype.UpdateValues=function(t){var e=this.UseNote?3:2;this.mListCsv=[],this.mDictionaryCsv={};for(var n=e,o=t.length;o>n;n++){var i=this.create(),r=t[n];if(!StringHelp.IsEmpty(r)){var a=r.split(",");if(a.length<i.ColNum())egret.error(StringHelp.Format("配置[{0}]数据缺少Line[{1}]--->{2}/{3}",this.ConfigName(),n,a.length,i.ColNum()));else{i.SetValues(a),i.OnInit();var s=this.GetKeyCsv(i);this.mDictionaryCsv[s]?egret.error(StringHelp.Format("配置[{0}]重复Line[{1}]Key[{2}]",this.ConfigName(),n,s.ToString())):(this.mListCsv.push(i),this.mDictionaryCsv[s]=i)}}}},t.prototype.GetItem=function(t){var e=this.mDictionaryCsv[t];return e||(egret.error(StringHelp.Format("[{0}]错误的key={1}",this.ConfigName(),t)),e=this.mListCsv[0]),e},t.prototype.GetAll=function(){return this.mListCsv},t}();__reflect(CsvBaseManager.prototype,"CsvBaseManager");var UpdateSigna=function(){function t(){this.Speed=1,this.OnSigna=new Signa}return t.AddUpdateSigna=function(e){t.UpdateObjMgr.push(e),1==t.UpdateObjMgr.length&&(t._intervalID=setInterval(function(){t.DoUpdateAll()},33))},t.RemoveUpdateSigna=function(e){Help.ArrayRemove(t.UpdateObjMgr,e),0==t.UpdateObjMgr.length&&clearInterval(t._intervalID)},t.DoUpdateAll=function(){for(var e=0,n=t.UpdateObjMgr;e<n.length;e++){var o=n[e];o.OnSigna.Send()}},t.GetUpdateObj=function(e){var n=t.UpdateObjSpeedMgr[e];return n||(n=new t,t.UpdateObjSpeedMgr[e]=n),n},t.UpdateObjMgr=new Array,t.UpdateObjSpeedMgr={},t._intervalID=0,t}();__reflect(UpdateSigna.prototype,"UpdateSigna");var UpdateObj=function(){function t(t){this._clearCall=new FunctionArry,this._isPlaying=!1,this._updateSigna=UpdateSigna.GetUpdateObj(t)}return t.prototype.Start=function(t,e){this._call=t,this._caller=e,this._isPlaying||(this._isPlaying=!0,0==this._updateSigna.OnSigna.mCalls.length&&UpdateSigna.AddUpdateSigna(this._updateSigna),this._clearCall.Add(this._updateSigna.OnSigna.AddListen(this.Invoke,this)))},t.prototype.Stop=function(){this._isPlaying&&(this._isPlaying=!1,this._clearCall.InvokeAndClear(),0==this._updateSigna.OnSigna.mCalls.length&&UpdateSigna.AddUpdateSigna(this._updateSigna))},t.prototype.SetSpeed=function(t){this._isPlaying?(this.Stop(),this._updateSigna=UpdateSigna.GetUpdateObj(t),this.Start(this._call,this._caller)):this._updateSigna=UpdateSigna.GetUpdateObj(t)},t.prototype.Invoke=function(){this._call.call(this._caller)},t}();__reflect(UpdateObj.prototype,"UpdateObj",["IUpdateObjNew"]);var TimerSigna=function(){function t(t){var e=this;this.Time=1,this.OnSigna=new Signa,this.Time=t,this.Timer=new egret.Timer(t,0),this.Timer.addEventListener(egret.TimerEvent.TIMER,function(){e.OnSigna.Send()},this)}return t.GetUpdateObj=function(e){var n=t.TimerSpeedMgr[e];return n||(n=new t(e),t.TimerSpeedMgr[e]=n),n},t.TimerSpeedMgr={},t}();__reflect(TimerSigna.prototype,"TimerSigna");var TimerObj=function(){function t(t){this._clearCall=new FunctionArry,this._isPlaying=!1,this.testId=0,this._updateSigna=TimerSigna.GetUpdateObj(t),this.testId=this._updateSigna.OnSigna.mCalls.length+1}return t.prototype.Start=function(t,e){this._call=t,this._caller=e,this._isPlaying||(this._isPlaying=!0,this._updateSigna.Timer.start(),this._clearCall.Add(this._updateSigna.OnSigna.AddListen(this.Invoke,this)))},t.prototype.Stop=function(){this._isPlaying&&(this._isPlaying=!1,this._clearCall.InvokeAndClear(),0==this._updateSigna.OnSigna.mCalls.length&&this._updateSigna.Timer.stop())},t.prototype.SetSpeed=function(t){this._isPlaying?(this.Stop(),this._updateSigna=TimerSigna.GetUpdateObj(t),this.Start(this._call,this._caller)):this._updateSigna=TimerSigna.GetUpdateObj(t)},t.prototype.Invoke=function(){this._call.call(this._caller)},t}();__reflect(TimerObj.prototype,"TimerObj",["IUpdateObjNew"]);var MAX_PLAYER=4,GameLogic=function(){function t(t){this.roomInfo=null,this.finishCount=0,this.rollHandArrLen=MAX_PLAYER,this.rollHandArr=[],this.mySeatId=0,this.gameType=t,this.roomInfo=new RoomInfo,this.roomInfo.roomID=0,this.roomInfo.gameState=GameState.matching,this.roomInfo.firstHandIdx=-1,this.roomInfo.players=[],this.roomInfo.gameInfos=[],this.roomInfo.optIndex=0,this.roomInfo.optCD=5,this.roomInfo.playerNum=0,this.gameType==GameType.test,this.rollHandArrLen=MAX_PLAYER;for(var e=0;MAX_PLAYER>e;e++)this.roomInfo.gameInfos.push(null)}return t.prototype.playerEnter=function(t,e,n){if(GameDebug==DebugType.OffLine){this.roomInfo.players.push(t),this.roomInfo.playerNum=this.roomInfo.players.length,this.rollHandArrLen=this.roomInfo.playerNum;var o=new GameInfo;return o.state=0,o.seatid=this.roomInfo.players.length-1,this.roomInfo.gameInfos[this.roomInfo.players.length-1]=o,e&&(this.mySeatId=o.seatid),o.seatid}return this.rollHandArrLen=this.roomInfo.playerNum,e&&(this.mySeatId=n),n},t.prototype.nextOpt=function(){this.roomInfo.optIndex++,this.roomInfo.optIndex=this.roomInfo.optIndex%this.roomInfo.playerNum},t.prototype.roll=function(){var t=1+Math.floor(6*Math.random());return t},t.prototype.addPlayerToRollHandArr=function(t,e){if(this.rollHandArr.push(t),this.rollHandArr.length>=this.rollHandArrLen)if(console.info("rollHandArr",this.rollHandArr),this.selFirstHander())e&&e.success();else{this.rollHandArrLen=this.rollHandArr.length,console.info("存在点数同时最大的玩家：",this.rollHandArrLen);for(var n=0;n<this.rollHandArrLen;n++)e&&e["continue"](this.rollHandArr[n]);this.rollHandArr.splice(0,this.rollHandArr.length)}},t.prototype.selFirstHander=function(){for(var t=0,e=0;e<this.rollHandArr.length;e++){var n=this.roomInfo.gameInfos[this.rollHandArr[e]].firstHandRoll;n>=t&&(t=n)}for(var o=[],e=0;e<this.rollHandArr.length;e++){var n=this.roomInfo.gameInfos[this.rollHandArr[e]].firstHandRoll;n==t&&o.push(this.rollHandArr[e])}return 1==o.length?(this.roomInfo.firstHandIdx=o[0],this.roomInfo.optIndex=this.roomInfo.firstHandIdx,!0):(this.rollHandArr=o,!1)},t.prototype.addRollStep=function(t,e){this.roomInfo.gameInfos[t].nowRoll=e,this.roomInfo.gameInfos[t].preStep=this.roomInfo.gameInfos[t].nowStep,this.roomInfo.gameInfos[t].nowStep+=e;var n=this.checkStep(t);return this.nextOpt(),console.info("RollStep:",t,"-当前在-",this.roomInfo.gameInfos[t].nowStep),{step:this.roomInfo.gameInfos[t].nowStep,out:n}},t.prototype.setStep=function(t,e){this.roomInfo.gameInfos[t].preStep=this.roomInfo.gameInfos[t].nowStep,this.roomInfo.gameInfos[t].nowStep=e;var n=this.checkStep(t);return console.info("setStep:",t,"-当前在-",this.roomInfo.gameInfos[t].nowStep),{step:this.roomInfo.gameInfos[t].nowStep,out:n}},t.prototype.checkStep=function(t){var e=0;return this.roomInfo.gameInfos[t].nowStep>this.roomInfo.gameInfos[t].maxStep&&(e=this.roomInfo.gameInfos[t].nowStep-this.roomInfo.gameInfos[t].maxStep,this.roomInfo.gameInfos[t].nowStep=2*this.roomInfo.gameInfos[t].maxStep-this.roomInfo.gameInfos[t].nowStep),e},t.prototype.cashEvent=function(t,e){if(GameMapEvents[e]){console.info("触碰到棋子事件",GameMapEvents[e]);var n=GameMapEvents[e].name;switch(n){case"start":break;case"tree":break;case"ladder":var o=GameMapEvents[e].toIndex;this.setStep(t,o);break;case"snake":var o=GameMapEvents[e].toIndex;this.setStep(t,o);break;case"destination":var o=GameMapEvents[e].toIndex}return GameMapEvents[e]}return null},t.prototype.getFirstHander=function(){return this.roomInfo.firstHandIdx},t.prototype.getMySeatId=function(){return this.mySeatId},t.prototype.setFinish=function(t){this.finishCount++,this.roomInfo.gameInfos[t].state=9},t}();__reflect(GameLogic.prototype,"GameLogic");var GameEvents=function(){function t(){}return t.CHANGE_PLAYER_SKIN="CHANGE_PLAYER_SKIN",t.LOAD_RANK_PAGE="LOAD_RANK_PAGE",t.DISPATCH_CHAT_MESSAGE="DISPATCH_CHAT_MESSAGE",t.ShowReward="ShowReward",t.PlayerGoldUIUpdate="PlayerGoldUIUpdate",t}();__reflect(GameEvents.prototype,"GameEvents");var IPacket=function(){function t(){this.pt=""}return t}();__reflect(IPacket.prototype,"IPacket");var CS_Packet=function(t){function e(){var e=t.call(this)||this;return e.tk="",e.uid=0,e.zid=0,e.tk=UserManager.instance().getUserInfo().token,e.uid=UserManager.instance().getUserInfo().uid,e.zid=0,e}return __extends(e,t),e}(IPacket);__reflect(CS_Packet.prototype,"CS_Packet");var SC_Packet=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ret=1,e}return __extends(e,t),e}(IPacket);__reflect(SC_Packet.prototype,"SC_Packet");var CS_Ping=function(t){function e(){var e=t.call(this)||this;return e.pt="Ping",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_Ping.prototype,"CS_Ping");var CS_UserLogin=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.acc="zhangte",e.pw=1,e.code="",e.inviteId=0,e.avatarUrl="",e.gender=1,e.nickName="游客",e.pt="UserLogin",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_UserLogin.prototype,"CS_UserLogin");var SC_UserLogin=function(t){function e(){var e=t.call(this)||this;return e.ret=-1,e.userData=null,e.playerData=null,e.pt="UserLogin",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_UserLogin.prototype,"SC_UserLogin");var CS_UpdatePlayerData=function(t){function e(){var e=t.call(this)||this;return e.playerData=null,e.pt="UpdatePlayerData",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_UpdatePlayerData.prototype,"CS_UpdatePlayerData");var SC_UpdatePlayerData=function(t){function e(){var e=t.call(this)||this;return e.playerData=null,e.pt="UpdatePlayerData",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_UpdatePlayerData.prototype,"SC_UpdatePlayerData");var CS_GetPackageList=function(t){function e(){var e=t.call(this)||this;return e.pt="GetPackageList",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_GetPackageList.prototype,"CS_GetPackageList");var SC_GetPackageList=function(t){function e(){var e=t.call(this)||this;return e.packlist={},e.itemlist={},e.pt="GetPackageList",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_GetPackageList.prototype,"SC_GetPackageList");var CS_GetItemList=function(t){function e(){var e=t.call(this)||this;return e.pt="GetItemList",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_GetItemList.prototype,"CS_GetItemList");var SC_GetItemList=function(t){function e(){var e=t.call(this)||this;return e.itemlist={},e.pt="GetItemList",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_GetItemList.prototype,"SC_GetItemList");var CS_UsePropItem=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.num=0,e.pt="UsePropItem",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_UsePropItem.prototype,"CS_UsePropItem");var SC_UsePropItem=function(t){function e(){var e=t.call(this)||this;return e.pt="UsePropItem",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_UsePropItem.prototype,"SC_UsePropItem");var CS_RomeLogin=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.roomid=0,e.playerData=null,e.pt="RomeLogin",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_RomeLogin.prototype,"CS_RomeLogin");var SC_RomeLogin=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.roomid=0,e.seatid=-1,e.playerData=null,e.status=0,e.pt="RomeLogin",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_RomeLogin.prototype,"SC_RomeLogin");var CS_RomeLoguot=function(t){function e(){var e=t.call(this)||this;return e.seatid=0,e.roomid=0,e.pt="RomeLoguot",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_RomeLoguot.prototype,"CS_RomeLoguot");var SC_RomeLoguot=function(t){function e(){var e=t.call(this)||this;return e.seatid=0,e.pt="RomeLoguot",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_RomeLoguot.prototype,"SC_RomeLoguot");var CS_RoomInfo=function(t){function e(){var e=t.call(this)||this;return e.roomid=0,e.pt="RomeInfo",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_RoomInfo.prototype,"CS_RoomInfo");var SC_RoomInfo=function(t){function e(){var e=t.call(this)||this;return e.roominfo=null,e.pt="RomeInfo",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_RoomInfo.prototype,"SC_RoomInfo");var CS_StartGame=function(t){function e(){var e=t.call(this)||this;return e.roomid=0,e.seatid=0,e.pt="StartGame",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_StartGame.prototype,"CS_StartGame");var SC_StartGame=function(t){function e(){var e=t.call(this)||this;return e.seatid=0,e.pt="StartGame",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_StartGame.prototype,"SC_StartGame");var CS_Operation=function(t){function e(){var e=t.call(this)||this;return e.roomid=0,e.seatid=0,e.rollNum=0,e.optType=0,e.pt="Operation",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_Operation.prototype,"CS_Operation");var SC_Operation=function(t){function e(){var e=t.call(this)||this;return e.seatid=0,e.rollNum=0,e.optType=0,e.firstHandSeatId=-1,e.moveArr=[],e.pt="Operation",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_Operation.prototype,"SC_Operation");var CS_EndGame=function(t){function e(){var e=t.call(this)||this;return e.roomid=0,e.pt="EndGame",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_EndGame.prototype,"CS_EndGame");var SC_EndGame=function(t){function e(){var e=t.call(this)||this;return e.pt="EndGame",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_EndGame.prototype,"SC_EndGame");var CS_Chat=function(t){function e(){var e=t.call(this)||this;return e.roomid=0,e.seatid=0,e.msg="",e.pt="Chat",e}return __extends(e,t),e}(CS_Packet);__reflect(CS_Chat.prototype,"CS_Chat");var SC_Chat=function(t){function e(){var e=t.call(this)||this;return e.seatid=0,e.msg="",e.pt="Chat",e}return __extends(e,t),e}(SC_Packet);__reflect(SC_Chat.prototype,"SC_Chat");var UserInfo=function(){function t(){this.uid=0,this.token="",this.isNewPlayer=""}return t}();__reflect(UserInfo.prototype,"UserInfo");var PlayerInfo=function(){function t(){this.id=0,this.nickName="游客",this.gender=1,this.newPlayer=0,this.avatarUrl="https://lg-3q7kbp58-1257126548.cos.ap-shanghai.myqcloud.com/images/test/ball.png",this.diamond=0,this.gold=1e4,this.loginTime="",this.myScans=[],this.selectScan=0,this.myEmoticons=[],this.gameTotalCount=0,this.getFirstCount=0}return t}();__reflect(PlayerInfo.prototype,"PlayerInfo");var GameInfo=function(){function t(){this.state=0,this.seatid=-1,this.firstHandRoll=0,this.nowStep=0,this.nowRoll=0,this.preStep=0,this.maxStep=47}return t}();__reflect(GameInfo.prototype,"GameInfo");var RoomInfo=function(){function t(){this.roomID=0,this.playerNum=4,this.gameState=0,this.firstHandIdx=-1,this.players=[],this.gameInfos=[],this.optIndex=0,this.optCD=5}return t}();__reflect(RoomInfo.prototype,"RoomInfo");var ShoppingItemInfo=function(){function t(){this.name="",this.price=0,this.id=0,this.shopdataArr=[],this.itemType=null,this.sourceName=""}return t}();__reflect(ShoppingItemInfo.prototype,"ShoppingItemInfo");var Displayobj=function(){function t(t){this._transform=null,this.ChildId=-1,this.display=t,LayerManager.Instance.AddForward(this.display,MyLayerEnum.Middle),Util.setAnchorMiddle(this.display)}return t.prototype.SetPos=function(t,e){this.display.x=t,this.display.y=e},t.prototype.SetScale=function(t,e){this.display.scaleX=t,this.display.scaleY=e},t.prototype.SetTransform=function(t,e){this._transform!=t&&(this._transform&&Help.ArrayRemove(this._transform.DisplayobjChilds,this),this._transform=t,e?(t.DisplayobjChilds[e.ChildId]=this,this.ChildId=e.ChildId):this.ChildId=t.DisplayobjChilds.push(this)-1)},t.prototype.Hide=function(){},t}();__reflect(Displayobj.prototype,"Displayobj",["IDisplay"]);var GameCameraSingle=function(){function t(){this.SceneCamera=new MyUpateObj(null)}return t.prototype.Clear=function(){this.SceneCamera.Clear()},t.Interest=SignaManger.Instance.One(t),t}();__reflect(GameCameraSingle.prototype,"GameCameraSingle",["SignaClear"]);var GameCamera=function(t){function e(){var e=t.call(this)||this;GameCameraSingle.Interest.SceneCamera.set(e),e.Sprite=new egret.Sprite,Util.setAnchorMiddle(e.Sprite),LayerManager.Instance.AddForward(e.Sprite,MyLayerEnum.UI);var n=Util.getScreenCenterPos();return e.EgretX=n[0],e.EgretY=n[1],e.SetPos(n[0],n[1]),e}return __extends(e,t),e.prototype.SetPos=function(e,n){t.prototype.SetPos.call(this,e,n);for(var o=0,i=this.Childs;o<i.length;o++){var r=i[o];r.ReSetPos()}},e.prototype.ScreenToWold=function(t,e){var n=t-this.EgretX+this._x,o=e-this.EgretY+this._y;return[n,o]},e.prototype.WoldScreenTo=function(t,e){var n=t+this.EgretX-this._x,o=e+this.EgretY-this._y;return[n,o]},e.prototype.debugPos=function(){var t=this.Sprite;t.x=this.EgretX,t.y=this.EgretY,t.graphics.beginFill(16711680),t.graphics.drawRect(1,1,2,2),t.graphics.endFill()},e}(Transform);__reflect(GameCamera.prototype,"GameCamera");var AssetAdapter=function(){function t(){t.Instance=this}return t.prototype.getAsset=function(t,e,n){function o(o){e.call(n,o,t)}if(RES.hasRes(t)){var i=RES.getRes(t);i?o(i):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t.Instance=null,t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var MyLayerEnum;!function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Skill=2]="Skill",t[t.UI=3]="UI",t[t.Max=4]="Max"}(MyLayerEnum||(MyLayerEnum={}));var LayerManager=function(){function t(){this.Root=null,this.LayerMgr=[],this.LayerList=[];for(var t=0;t<MyLayerEnum.Max;t++){this.LayerMgr.push(new Array);var e=new egret.DisplayObjectContainer;this.LayerList.push(e)}}return t.OnCreate=function(){return t.Instance=new t,t.Instance.SetRoot(egret.MainContext.instance.stage),t.Instance},t.prototype.SetRoot=function(t){this.Root=t;for(var e=0;e<MyLayerEnum.Max;e++)t.addChild(this.LayerList[e])},t.prototype.AddForward=function(t,e){this.LayerList[e].addChildAt(t,0)},t.prototype.AddBackwardd=function(t,e){this.LayerList[e].addChild(t)},t.prototype.removeForward=function(t){this.LayerList[t].numChildren>0&&this.LayerList[t].removeChildAt(0)},t.prototype.GetLayer=function(t){return void 0===t&&(t=MyLayerEnum.Middle),this.LayerList[t]},t.Instance=null,t}();__reflect(LayerManager.prototype,"LayerManager");var InitSdkHandel=function(){function t(t,e){this.success=null,this.fail=null,this.success=t,this.fail=e}return t}();__reflect(InitSdkHandel.prototype,"InitSdkHandel");var DebugPlatform=function(){function t(){}return t.prototype.initSdk=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"what name?",avatarUrl:"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83erUbNicL4RicqD50sFfian0CRH9AkMbicN5q8YhaTeC4df8aG8MPkiaNwK8vM36f7OTppH2SdZOlpkTUvA/132"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setLoadingProgress=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.share=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.quit=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getContext=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{}]})})},t.prototype.getEntryPointData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{roomid:"123456"}]
})})},t.prototype.chooseAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.updateAsync=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||("undefined"!=typeof FBInstant?window.platform=new FaceBookPlatform:window.platform=new DebugPlatform);var HashMap=function(){function t(){this._length=0,this._length=0,this._content={}}return t.prototype.size=function(){return this._length},t.prototype.isEmpty=function(){return 0==this._length},t.prototype.keys=function(){var t=new Array(this._length),e=0;for(var n in this._content)t[e]=n,e++;return t},t.prototype.eachKey=function(t,e){for(var n in this._content)t.apply(e,[n])},t.prototype.eachValue=function(t,e){for(var n in this._content)t.apply(e,[this._content[n]])},t.prototype.values=function(){var t=new Array(this._length),e=0;for(var n in this._content)t[e]=this._content[n],e++;return t},t.prototype.containsValue=function(t){for(var e in this._content)if(this._content[e]===t)return!0;return!1},t.prototype.containsKey=function(t){return void 0!=this._content[t]?!0:!1},t.prototype.get=function(t){var e=this._content[t];return void 0!==e?e:null},t.prototype.getValue=function(t){return this.get(t)},t.prototype.put=function(t,e){if(null===t)throw new Error("cannot put a value with undefined or null key!");if(null===e)return this.remove(t);if("string"!=typeof t&&"number"!=typeof t)throw new Error("JS不支持对象作为Key");var n=this._content[t];return n||(this._length+=1),this._content[t]=e,n},t.prototype.remove=function(t){var e=this._content[t];return e&&(delete this._content[t],this._length--),e},t.prototype.clear=function(){for(var t in this._content)delete this._content[t];this._length=0},t.prototype.clone=function(){var e=new t;for(var n in this._content)e.put(n,this._content[n]);return e},t.prototype.toString=function(){for(var t=this.keys(),e=this.values(),n="HashMap Content:\n",o=0;o<t.length;o++)n+=t[o]+" -> "+e[o]+"\n";return n},t._keyArray=[],t}();__reflect(HashMap.prototype,"HashMap");var HttpHandler=function(){function t(){this._protoMap={}}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.registerProtocol=function(t,e){this._protoMap[t]=e},t.prototype.sendLoginMessage=function(t){var e=GameConfig.loginUrl+"api/"+t.pt,n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.open(e,egret.HttpMethod.POST),n.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostError,this),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(t)),console.info("http sendLoginMessage:",t)},t.prototype.sendGameMessage=function(t){var e=GameConfig.loginUrl+"api/"+t.pt,n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.open(e,egret.HttpMethod.POST),n.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostError,this),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify(t))},t.prototype.dispatch=function(t){var e=this;t.forEach(function(t){e._protoMap[t.pt]?e._protoMap[t.pt].handleProtocol(t):Logger.log("未定义pt "+t.pt)})},t.prototype.onPostComplete=function(t){try{var e=t.currentTarget;this.dispatch(JSON.parse(e.response))}catch(n){Logger.log("返回数据必须为数组：",n)}},t.prototype.onPostError=function(t){Logger.log("发送消息错误: ",t)},t._instance=null,t}();__reflect(HttpHandler.prototype,"HttpHandler");var Logger=console;Logger.assert=function(t,e){Logger.log(t,e||"")};var Util=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},t.formatDateMonth=function(t){var e=t.getMonth()+1,n=t.getDate();return e+"月"+n+"日"},t.safeCopy=function(t,e,n,o){n=n||"",o=o||"";for(var i in e){var r=n+i.replace(o,""),a=typeof t[r];"undefined"!==a&&("number"!==a?e.hasOwnProperty(i)&&(t[i]=e[i]):t[r]=parseFloat(e[i]))}return t},t.safeExtend=function(t,e){for(var n in e)t[n]=e[n];return t},t.setAnchorMiddle=function(t){t.$anchorOffsetX=t.width/2,t.$anchorOffsetY=t.height/2},t.getScreenCenterPos=function(){var t=[];return t.push(UIManager.instance().stageWidth()/2),t.push(UIManager.instance().stageHeight()/2),t},t.save_key=function(t,e){var n=e;n=JSON.stringify(n),egret.localStorage.setItem(t,n)},t.get_key=function(t){var e=egret.localStorage.getItem(t);return e&&"undefined"!=e&&"null"!=e?JSON.parse(e):null},t.del_key=function(t){return egret.localStorage.removeItem(t),!0},t.getBase64Image=function(t){var e=RES.getRes(t),n=new egret.Bitmap(e);return n.texture.toDataURL("image/png")},t}();__reflect(Util.prototype,"Util");var HostAdress=function(){function t(){}return t.prototype.completeAddress=function(){var t=this.encryption?"wss":"ws";return t+"://"+this.host+":"+this.port},t}();__reflect(HostAdress.prototype,"HostAdress");var NetSocketStatus;!function(t){t[t.None=0]="None",t[t.BeginConnect=1]="BeginConnect",t[t.Connected=2]="Connected",t[t.ConnectFailed=3]="ConnectFailed",t[t.Disconnect=4]="Disconnect",t[t.Error=5]="Error"}(NetSocketStatus||(NetSocketStatus={}));var NetSocket=function(){function t(){this.status=NetSocketStatus.None,this.recFuncMaps=new Object,this.adress=new HostAdress}return Object.defineProperty(t.prototype,"isConnected",{get:function(){return null==this.socket?!1:this.socket.connected},enumerable:!0,configurable:!0}),t.prototype.addListenerMessage=function(t,e,n){if(console.log(this.recFuncMaps),null==this.recFuncMaps[t]){var o=new ReciveFunction;o.ID=t,o.handler=e,o.thisObj=n,this.recFuncMaps[t]=o}else console.log("The same ID already exists in the receive message list:"+t)},t.prototype.connect=function(t,e,n,o){(""==t||0==e)&&(console.error("[socket] connect error,host or port is null.."),this.status=NetSocketStatus.None),this.funcObj=o,this.onSocketFunc=n,this.connectToServer(t,e,!1)},t.prototype.secureConnect=function(t,e,n,o){(""==t||0==e)&&(console.error("[socket] connect error,host or port is null.."),this.status=NetSocketStatus.None),this.funcObj=o,this.onSocketFunc=n,this.connectToServer(t,e,!0)},t.prototype.send=function(t,e){if(GameDebug==DebugType.OffLine){console.info("offline onReceive:",JSON.parse(e));var n=this.recFuncMaps[t];return void n.handler.call(n.thisObj,e)}return this.isConnected?(console.info("ws send:",e),this.socket.writeUTF(e),this.socket.flush(),void 0):void this.close()},t.prototype.close=function(){null!=this.socket&&(this.socket.removeEventListener(egret.Event.CONNECT,this.onConnectSucceed,this),this.socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceive,this),this.socket.removeEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.socket.close(),this.socket=null),this.status=NetSocketStatus.None},t.prototype.connectToServer=function(t,e,n){this.adress.host=t,this.adress.port=e,this.adress.encryption=n,this.onInit()},t.prototype.onInit=function(){0==this.isConnected&&(this.status=NetSocketStatus.BeginConnect,null==this.socket&&(this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.Event.CONNECT,this.onConnectSucceed,this),this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceive,this),this.socket.addEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this)),this.socket.connectByUrl(this.adress.completeAddress()))},t.prototype.onConnectSucceed=function(){this.status=NetSocketStatus.Connected,console.log("[socket] connect server succeed!"),null!=this.onSocketFunc&&null!=this.funcObj&&this.onSocketFunc.call(this.funcObj,this.status)},t.prototype.onReceive=function(t){var e=this.socket.readUTF(),n=JSON.parse(e).pt;if(null!=this.recFuncMaps[n]){if(1!=JSON.parse(e).ret)return void console.error("ws onReceive err:",e);console.info("ws onReceive:",e);var o=this.recFuncMaps[n];o.handler.call(o.thisObj,e)}},t.prototype.onClose=function(){this.status=NetSocketStatus.Disconnect,console.log("[socket] server close!"),null!=this.onSocketFunc&&null!=this.funcObj&&this.onSocketFunc.call(this.funcObj,this.status)},t.prototype.onError=function(){this.status=NetSocketStatus.Error,console.error("[socket] connect server error!"),null!=this.onSocketFunc&&null!=this.funcObj&&this.onSocketFunc.call(this.funcObj,this.status)},t.prototype.getUint8Array=function(t){for(var e=[],n=0;n<t.dataView.byteLength;n++)e.push(t.dataView.getUint8(n));return e},t}();__reflect(NetSocket.prototype,"NetSocket",["INetSocket"]);var ReciveFunction=function(){function t(){}return t}();__reflect(ReciveFunction.prototype,"ReciveFunction");var NetUtil=function(){function t(){}return Object.defineProperty(t,"ApcData",{get:function(){return this._ApcData},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MessageData",{get:function(){return this._MessageData},enumerable:!0,configurable:!0}),t}();__reflect(NetUtil.prototype,"NetUtil");var ConfigInfo=function(){function t(){}return t.myScansHasMap=null,t}();__reflect(ConfigInfo.prototype,"ConfigInfo");var LayerType;!function(t){t[t.LAYER_SCENE=0]="LAYER_SCENE",t[t.LAYER_UI=1]="LAYER_UI",t[t.LAYER_FULLSCREEN=2]="LAYER_FULLSCREEN",t[t.LAYER_POPUP=3]="LAYER_POPUP",t[t.LAYER_EFFECT=4]="LAYER_EFFECT",t[t.LAYER_TOOLTIP=5]="LAYER_TOOLTIP",t[t.LAYER_LOADING=6]="LAYER_LOADING"}(LayerType||(LayerType={}));var LayerConfig=function(){function t(t,e,n,o){this.touchEnabled=t,this.touchChildren=e,this.model=n,this.alpha=o}return t}();__reflect(LayerConfig.prototype,"LayerConfig");var LAYER_CHECK_CONFIGS=(_a={},_a[LayerType.LAYER_SCENE]=new LayerConfig(!1,!0,!1,0),_a[LayerType.LAYER_UI]=new LayerConfig(!1,!0,!1,0),_a[LayerType.LAYER_FULLSCREEN]=new LayerConfig(!0,!0,!0,1),_a[LayerType.LAYER_POPUP]=new LayerConfig(!0,!0,!0,.6),_a[LayerType.LAYER_EFFECT]=new LayerConfig(!1,!1,!1,0),_a[LayerType.LAYER_TOOLTIP]=new LayerConfig(!1,!1,!1,0),_a[LayerType.LAYER_LOADING]=new LayerConfig(!0,!1,!0,0),_a),_a,RENDER_OFFSET_WIDTH=100,RENDER_OFFSET_HEIGHT=100,ACTOR_SORT_INTERVAL=10,MONSTER_TRACE_DIST=2e3,PathType;!function(t){t[t.OBSTACLE=-1]="OBSTACLE",t[t.WALKABLE=0]="WALKABLE",t[t.TRANSPARENT=1]="TRANSPARENT"}(PathType||(PathType={}));var PathNode=function(){function t(t,e,n){this.label=t,this.type=e,this.color=n}return t}();__reflect(PathNode.prototype,"PathNode");var PATH_TYPES=[new PathNode("障碍",PathType.OBSTACLE,16711680),new PathNode("可行走",PathType.WALKABLE,0),new PathNode("透明",PathType.TRANSPARENT,255)],SceneType;!function(t){t[t.ST_HOME=0]="ST_HOME",t[t.ST_NORMAL_COPY=1]="ST_NORMAL_COPY",t[t.ST_EQUIP_COPY=2]="ST_EQUIP_COPY",t[t.ST_BOSS_LIANYU=3]="ST_BOSS_LIANYU",t[t.ST_BOSS_WORLD=4]="ST_BOSS_WORLD",t[t.ST_BOSS_COPY=5]="ST_BOSS_COPY",t[t.ST_COIN_COPY=6]="ST_COIN_COPY",t[t.ST_EXP_COPY=7]="ST_EXP_COPY",t[t.ST_METERIAL_COPY=8]="ST_METERIAL_COPY"}(SceneType||(SceneType={}));var SceneElementType;!function(t){t[t.SET_NPC=0]="SET_NPC",t[t.SET_ENTRY_POINT=1]="SET_ENTRY_POINT",t[t.SET_SCENERY=2]="SET_SCENERY",t[t.SET_ROLE_BORN_POINT=3]="SET_ROLE_BORN_POINT",t[t.SET_MONSTER_BORN_POINT=4]="SET_MONSTER_BORN_POINT",t[t.SET_COLLECT_GOODS=5]="SET_COLLECT_GOODS",t[t.SET_EVENT_POINT=6]="SET_EVENT_POINT",t[t.SET_PATROL_PATH=7]="SET_PATROL_PATH"}(SceneElementType||(SceneElementType={}));var SceneRawData=function(){function t(){this.npcBornData=[],this.monsterBornData=[],this.roleBornData=[],this.entryData=[]}return t}();__reflect(SceneRawData.prototype,"SceneRawData");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,o){function i(t){e.call(o,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(o))}var a=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(o,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(o,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ConfigManager=function(){function t(){}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.loadAllData=function(){},t.prototype.reloadData=function(t){return null},t.prototype.getData=function(t){return null},t._instance=null,t}();__reflect(ConfigManager.prototype,"ConfigManager");var DragonBoneManager=function(){function t(){this._assetMap={}}return t.instance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.createDragonByName=function(t){var e=this._assetMap[t];if(e)return e;var n=t+"_ske_dbbin",o=t+"_tex_json",i=t+"_tex_png";return e=this.createDragonFactory(n,o,i),this._assetMap[t]=e,e},t.prototype.createDragonFactory=function(t,e,n){var o=RES.getRes(t),i=RES.getRes(e),r=RES.getRes(n),a=new dragonBones.EgretFactory;return a.parseDragonBonesData(o),a.parseTextureAtlasData(i,r),a},t._instance=null,t}();__reflect(DragonBoneManager.prototype,"DragonBoneManager");var EffectManager=function(){function t(){this.MAX_POOL_SIZE=10,this._assetMap={},this._effectMap={}}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.curStage=function(){return egret.MainContext.instance.stage},t.prototype.createFactory=function(t){var e=this._assetMap[t];if(e)return e;var n=RES.getRes(t+"_json"),o=RES.getRes(t+"_png");return n&&o?(e=new egret.MovieClipDataFactory(n,o),this._assetMap[t]=e,e):(Logger.warn("not find effect resource of "+t),null)},t.prototype.createEffect=function(t,e,n){var o=t+"::"+e,i=this._effectMap[o];if(i&&i.length>0)return i.pop();var r=this.createFactory(t);return r?new UIEffect(t,e,r):null},t.prototype.destoryEffect=function(t){if(t){var e=t.getName()+"::"+t.getAction(),n=this._effectMap[e];n||(n=new Array,this._effectMap[e]=n),t.stop(),n.length<this.MAX_POOL_SIZE&&n.push(t)}},t._instance=null,t}();__reflect(EffectManager.prototype,"EffectManager");var EventManager=function(){function t(){this._handlers=null}return t.instance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.addEventListener=function(t,e,n){null==this._handlers&&(this._handlers=new HashMap);var o=this._handlers.get(t);null==o&&(o=new Array,this._handlers.put(t,o));var i=this.indexOf(e,o);-1==i?o.push({func:e,owner:n}):Logger.log("EventType:"+t+" repeat register !!!!!!!!!!!")},t.prototype.indexOf=function(t,e){for(var n=0,o=e.length;o>n;++n)if(e[n].func===t)return n;return-1},t.prototype.removeEventListener=function(t,e){if(null!=this._handlers&&this._handlers.size()>0){var n=this._handlers.get(t);if(null!=n){var o=this.indexOf(e,n);-1==o?Logger.log("EventType:"+t+" removeEventListener error !!!!!!!!!!!"):n.splice(o,1),0==n.length&&this._handlers.remove(t)}}},t.prototype.dispatchEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(null!=this._handlers&&this._handlers.size()>0){var o=this._handlers.get(t);null!=o&&o.forEach(function(t){var n=t.func;n&&n.call.apply(n,[t.owner].concat(e))})}},t._instance=null,t}();__reflect(EventManager.prototype,"EventManager");var SceneManager=function(){function t(){this._percent=0,this._loadingWindow=null,this._rawdataMap=new HashMap,this._isClear=!1,this._curScene=null}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.loadData=function(t){if(!this._rawdataMap.containsKey(t)){var e=new SceneRawData;this._rawdataMap.put(t,e)}},t.prototype.enterScene=function(t,e){return this._curScene&&this._curScene.getSceneID()===e?void Logger.warn("[enterScene]重复进入场景"+this._curScene.getMapID()):(this.exitScene(!0),this._curScene&&this._curScene.leave(),this._curScene=new SceneRender(t,e),void this._curScene.enter())},t.prototype.exitScene=function(t){this._curScene&&(this._curScene.leave(),this._curScene=null)},t.prototype.calcScenePID=function(t){return 65535&t},t.prototype.calcSceneGID=function(t){return(4294901760&t)>>16},t.prototype.calcSceneID=function(t,e){return t|e<<16},t._instance=null,t}();__reflect(SceneManager.prototype,"SceneManager");var UIManager=function(){function t(){this._windowMap={}}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.curStage=function(){return egret.MainContext.instance.stage},t.prototype.stageWidth=function(){return egret.MainContext.instance.stage.stageWidth},t.prototype.stageHeight=function(){return egret.MainContext.instance.stage.stageHeight},t.prototype.serviceWidth=function(){return egret.Capabilities.boundingClientWidth},t.prototype.serviceHeight=function(){return egret.Capabilities.boundingClientHeight},t.prototype.findWindow=function(t){return this._windowMap[t]},t.prototype.openWindow=function(t){var e=this._windowMap[t];if(!e){var n=egret.getDefinitionByName(t);return n?(e=new n(t),this.curStage().addChild(e),this._windowMap[t]=e,e.width=this.stageWidth(),e.height=this.stageHeight(),e):null}return e},t.prototype.closeWindow=function(t){var e=this._windowMap[t];e&&(console.info("closeWindow:",t),e.release(),this.curStage().removeChild(e),delete this._windowMap[t])},t.prototype.removeAllWindow=function(){console.info("removeAllWindow:");for(var t in this._windowMap)this._windowMap[t]&&(this._windowMap[t].release(),this.curStage().removeChild(this._windowMap[t]),delete this._windowMap[t])},t.prototype.getSourceNameByAtlasAndName=function(t,e){return t+"Atlas_json."+e},t.prototype.heightOffset=function(){return-(1136-t.instance().stageHeight())/2},t._instance=null,t}();__reflect(UIManager.prototype,"UIManager");var ActorRender=function(t){function e(e){var n=t.call(this)||this;return n._name="",n._visable=!1,n._destory=!1,n._name=e,n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRelease,n),n.addEventListener(egret.Event.RESIZE,n.onResize,n),n.onInit(),n}return __extends(e,t),e.prototype.getName=function(t){this._name=t},e.prototype.release=function(){this.onRelease()},e.prototype.onInit=function(){console.log("onInit")},e.prototype.onRelease=function(){console.log("onRelease")},e.prototype.onResize=function(){Logger.log("onResize")},e.prototype.hide=function(){this._visable=!1},e.prototype.show=function(){this._visable=!0},e.prototype.destroy=function(){this._destory=!0},e.prototype.isDestroy=function(){return this._destory},e}(eui.Component);__reflect(ActorRender.prototype,"ActorRender");var PieceMap=function(){function t(){}return t}();__reflect(PieceMap.prototype,"PieceMap");var SceneRender=function(t){function e(e,n){var o=t.call(this)||this;return o._viewWidth=600,o._viewHeight=400,o._pieceMap=null,o._layer=LayerType.LAYER_SCENE,o._sceneID=0,o._sceneType=0,o._scenePID=0,o._sceneGID=0,o._sceneType=e,o._sceneID=n,o._scenePID=SceneManager.instance().calcScenePID(n),o._sceneGID=SceneManager.instance().calcSceneGID(n),o}return __extends(e,t),e.prototype.getSceneID=function(){return this._sceneID},e.prototype.getMapID=function(){return this._scenePID},e.prototype.enter=function(){},e.prototype.leave=function(){},e}(eui.Component);__reflect(SceneRender.prototype,"SceneRender");var UIEffect=function(){function t(t,e,n){this._parent=null,this._name="",this._action="",this._effect=null,this._name=t,this._action=e,this._effect=new egret.MovieClip(n.generateMovieClipData(e)),this._effect.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRelease,this),this.onInit()}return t.prototype.getName=function(){return this._name},t.prototype.getAction=function(){return this._action},t.prototype.play=function(t,e){this._effect.x=0,this._effect.y=0,this._effect.gotoAndPlay(1,t),this._parent=e||egret.MainContext.instance.stage,this._parent.addChild(this._effect)},t.prototype.stop=function(){this._effect&&(this._effect.stop(),this.onRelease())},t.prototype.setParent=function(t){return this._effect?(this._parent&&this._parent.removeChild(this._effect),this._parent=t||egret.MainContext.instance.stage,void this._parent.addChild(this._effect)):void Logger.warn("empty effect")},t.prototype.onInit=function(){console.log("onInit")},t.prototype.onRelease=function(){this._parent&&null!=this&&(this._parent.removeChild(this._effect),this._parent=null),console.log("onRelease")},t}();__reflect(UIEffect.prototype,"UIEffect");var SongSheetCsv=function(){function t(){this.line=new Array}return t.prototype.SetValues=function(t){var e=0;this._INDEX=Number(t[e++]),this.line.push(this._INDEX),this._NAME=t[e++],this.line.push(this._NAME),this._RES=t[e++],this.line.push(this._RES),this._SPEED=Number(t[e++]),this.line.push(this._SPEED),this._VOLUME=Number(t[e++]),this.line.push(this._VOLUME)},t.prototype.ColNum=function(){return 5},Object.defineProperty(t.prototype,"INDEX",{get:function(){return this._INDEX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NAME",{get:function(){return this._NAME},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RES",{get:function(){return this._RES},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SPEED",{get:function(){return this._SPEED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VOLUME",{get:function(){return this._VOLUME},enumerable:!0,configurable:!0}),t.prototype.OnInit=function(){},t}();__reflect(SongSheetCsv.prototype,"SongSheetCsv",["CsvBase"]);var SongSheetCsvManage=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ConfigName=function(){return"SongSheet_csv"},e.prototype.UseNote=function(){return!0},e.prototype.GetKeyCsv=function(t){return t.INDEX},e.prototype.create=function(){return new SongSheetCsv},e}(CsvBaseManager);__reflect(SongSheetCsvManage.prototype,"SongSheetCsvManage");var ItemBase=function(){function t(){}return t}();__reflect(ItemBase.prototype,"ItemBase");var ItemEquip=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(ItemBase);__reflect(ItemEquip.prototype,"ItemEquip");var ItemSpace=function(){function t(){}return t}();__reflect(ItemSpace.prototype,"ItemSpace");var BagType;!function(t){t[t.MONEY=1]="MONEY",t[t.EQUIP=2]="EQUIP",t[t.PROP=3]="PROP",t[t.test1=4]="test1",t[t.test2=5]="test2",t[t.test3=6]="test3"}(BagType||(BagType={}));var BagManager=function(){function t(){this._bagSpace=null,this._moneyBag=null,this._equipBag=null,this._propBag=null,this.istest=!1}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.initAllBag=function(){null===this._bagSpace&&(this._bagSpace=new HashMap,this._equipBag=new HashMap,this._moneyBag=new HashMap,this._propBag=new HashMap)},t.prototype.clearAllBag=function(){null!==this._bagSpace&&(this._bagSpace.clear(),this._equipBag.clear(),this._moneyBag.clear(),this._propBag.clear())},t.prototype.testData=function(){for(var t=[],e=0;19>e;e++)t.push({type:200,id:e,index:e+200,overlap:99+e});for(var e=0;100>e;e++)t.push({type:300,id:e,index:e+200,overlap:99+e});this.getPackList({packlist:{},itemlist:t})},t.prototype.getBagByType=function(t){switch(this.istest||this.testData(),t){case BagType.EQUIP:return this._equipBag;case BagType.MONEY:return this._moneyBag;case BagType.PROP:return this._propBag;default:return this._propBag}},t.prototype.getPackList=function(t){var e=this;this.initAllBag(),this.clearAllBag();for(var n in t.packlist)this._bagSpace.put(n,t.packlist[n]);t.itemlist.map(function(t,n){var o=Math.floor(t.type/100);switch(o){case BagType.MONEY:e._moneyBag.put(n,t);break;case BagType.EQUIP:e._equipBag.put(n,t);break;case BagType.PROP:e._propBag.put(n,t)}})},t.prototype.getItemList=function(t){var e=this,n=null;t.itemlist.map(function(t,o){n=e.getBagByType(o),n.put(o,t)})},t.prototype.getBagspace=function(t){return this._bagSpace.get(t)},t.prototype.getItemInfo=function(t){},t.prototype.getRecycleEquip=function(){if(this._equipBag.size()<=16)return this._equipBag.values();for(var t=new Array,e=0,n=this._equipBag.values();e<n.length;e++){var o=n[e];if(t.length>=16)break;t.push(o)}return t},t._instance=null,t}();__reflect(BagManager.prototype,"BagManager");var GameManager=function(){function t(){this.gameLogic=null,this.MatchingTime=15e3,this.matchingTimer=null,this.waitClock=new Clock,this.timer=0,this.useTimeOut=0}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.init=function(){},t.prototype.enterGame=function(e,n){this.type=e,this.type==GameType.firendMode?this.MatchingTime=6e4:this.MatchingTime=15e3,console.info("enterGame:",e),MySceneManager.OnCreate().LoadGameScene(),UIManager.instance().openWindow("GameWindow"),this.gameLogic=new GameLogic(this.type),n>=0&&(t.instance().gameLogic.roomInfo.roomID=n),GameNetwork.Instance.reqRomeLogin(t.instance().gameLogic.roomInfo.roomID),this.waitClock.start()},t.prototype.matchingGame=function(){UIManager.instance().openWindow("MatchingWindow"),this.matchingTimer=new egret.Timer(1e3,Math.floor(this.MatchingTime/1e3)),this.matchingTimer.addEventListener(egret.TimerEvent.TIMER,this.matchingTimerFunc,this),this.matchingTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.matchingTimerComFunc,this),this.matchingTimer.start(),this.gameLogic.roomInfo.gameState=GameState.matching},t.prototype.matchingTimerFunc=function(){if(GameDebug==DebugType.OffLine){if(this.gameLogic.roomInfo.players.length>=MAX_PLAYER)return void GameNetwork.Instance.reqStartGame();if(this.type!=GameType.firendMode){var t=new PlayerInfo;t.id=this.gameLogic.roomInfo.players.length,t.nickName="离线测试"+t.id,GameNetwork.Instance.reqRomeLogin(this.gameLogic.roomInfo.roomID,t)}}},t.prototype.matchingTimerComFunc=function(){console.log("匹配超时"),this.endGame()},t.prototype.playerEnter=function(t){var e=this.gameLogic.roomInfo.players[t];if(this.getGameWindow()&&this.getGameWindow().playerEnter(t,e),UIManager.instance().findWindow("MatchingWindow")){var n=UIManager.instance().findWindow("MatchingWindow");n.playerEnter(t,e)}},t.prototype.readyGame=function(){if(console.info("readyGame:",this.type),this.matchingTimer&&(this.matchingTimer.stop(),this.matchingTimer.removeEventListener(egret.TimerEvent.TIMER,this.matchingTimerFunc,this),this.matchingTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.matchingTimerComFunc,this),this.matchingTimer=null),UIManager.instance().closeWindow("MatchingWindow"),this.timer=0,egret.startTick(this.update,this),this.gameLogic.roomInfo.gameState=GameState.gameStart,GameDebug==DebugType.OffLine&&this.getGameWindow()){this.getGameWindow().playStart();var t=this;this.waitClock.addTimer("startClock",2e3,function(e){t.firstHand(0),t.firstHand(1),t.firstHand(2),t.firstHand(3)})}},t.prototype.startGame=function(){var e=this;this.getGameWindow()&&this.getGameWindow().playStart(),e.gameLogic.roomInfo.gameState=GameState.gameing,t.instance().turnToSeatId(e.gameLogic.getFirstHander())},t.prototype.recomeGame=function(){this.matchingTimer&&(this.matchingTimer.stop(),this.matchingTimer.removeEventListener(egret.TimerEvent.TIMER,this.matchingTimerFunc,this),this.matchingTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.matchingTimerComFunc,this),this.matchingTimer=null),UIManager.instance().closeWindow("MatchingWindow"),this.timer=0,egret.startTick(this.update,this)},t.prototype.firstHand=function(t){GameNetwork.Instance.reqOperation(t,OperationType.firstHandRoll),this.gameLogic.roomInfo.gameState=GameState.firstHand,t==this.gameLogic.getMySeatId()},t.prototype.turnToSeatId=function(e){if(this.getGameWindow()){var n=this;return GameDebug==DebugType.OffLine&&9==this.gameLogic.roomInfo.gameInfos[e].state?(this.gameLogic.nextOpt(),void(this.gameLogic.roomInfo.playerNum-this.gameLogic.finishCount>1?this.turnToSeatId(n.gameLogic.roomInfo.optIndex):this.preEndGame())):void(1!=this.gameLogic.roomInfo.gameInfos[e].state&&(this.gameLogic.roomInfo.gameInfos[e].state=1,this.getGameWindow().showOperationBD(e,!0),GameDebug==DebugType.OffLine&&this.waitClock.addTimer("waitTurn",5e3,function(o){console.info("操作超时",e),t.instance().rollStep(e),n.getGameWindow().hideOperationBD(e)})))}},t.prototype.rollStep=function(t){1==this.gameLogic.roomInfo.gameInfos[t].state&&(this.waitClock.removeTimer("waitTurn"),this.gameLogic.roomInfo.optIndex=t,GameDebug==DebugType.OffLine?GameNetwork.Instance.reqOperation(t,OperationType.rollStep):t==this.gameLogic.getMySeatId()&&GameNetwork.Instance.reqOperation(t,OperationType.rollStep))},t.prototype.dealOperation=function(e){var n="";switch(e.optType){case OperationType.firstHandRoll:n="firstHandRoll",e.firstHandSeatId>=0?(this.gameLogic.roomInfo.firstHandIdx=e.firstHandSeatId,console.info("先手玩家:",this.gameLogic.getFirstHander()),t.instance().startGame()):(this.gameLogic.roomInfo.gameInfos[e.seatid].firstHandRoll=e.rollNum,t.instance().showRollFirstHand(e.seatid,e.rollNum));break;case OperationType.rollStep:if(n="rollStep",GameDebug==DebugType.OffLine){var o=this.gameLogic.addRollStep(e.seatid,e.rollNum);t.instance().playRollStep(e.seatid,e.rollNum,o.step,o.out)}else-1==e.rollNum?this.turnToSeatId(e.seatid):e.moveArr.length>0&&t.instance().playArrStep(e.seatid,e.rollNum,e.moveArr)}console.info("dealOperation:",n,e.seatid)},t.prototype.preEndGame=function(){console.info("游戏结束"),this.waitClock.stop(),this.waitClock.removeAllTimer(),UIManager.instance().openWindow("GameEndWindow")},t.prototype.endGame=function(t){return t?(this.gameLogic=null,egret.stopTick(this.update,this),MySceneManager.OnCreate().LoadMainScene(),UIManager.instance().openWindow("MainWindow"),this.matchingTimer&&(this.matchingTimer.stop(),this.matchingTimer.removeEventListener(egret.TimerEvent.TIMER,this.matchingTimerFunc,this),this.matchingTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.matchingTimerComFunc,this),this.matchingTimer=null),this.waitClock.stop(),void this.waitClock.removeAllTimer()):void GameNetwork.Instance.reqRomeLoguot(this.gameLogic.getMySeatId(),this.gameLogic.roomInfo.roomID)},t.prototype.showRollFirstHand=function(e,n){if(console.info("showRollFirstHand:",e,n),this.getGameWindow()){var o=this;this.getGameWindow().playRollFirst(e,n),GameDebug==DebugType.OffLine&&this.waitClock.addTimer("waitFirstHand"+e,3e3,function(n){o.gameLogic.addPlayerToRollHandArr(e,{success:function(){console.info("先手玩家:",o.gameLogic.getFirstHander()),o.gameLogic.roomInfo.gameState=GameState.gameing,t.instance().turnToSeatId(o.gameLogic.getFirstHander())},"continue":function(e){"number"==typeof e&&e>=0&&(GameDebug==DebugType.OffLine?t.instance().firstHand(e):e==o.gameLogic.getMySeatId()&&t.instance().firstHand(e))}})})}},t.prototype.playRollStep=function(e,n,o,i){console.info("playRollStep:",e,n),this.gameLogic.roomInfo.gameInfos[e].state=2;var r=this;this.getGameWindow()&&this.getGameWindow().playRoll(e,n,o,i),GameDebug==DebugType.OffLine&&this.waitClock.addTimer("waitRollStep"+e,4e3,function(n){r.gameLogic.roomInfo.gameInfos[e].state=3,t.instance().turnToSeatId(r.gameLogic.roomInfo.optIndex)})},t.prototype.playArrStep=function(t,e,n){this.gameLogic.roomInfo.gameInfos[t].state=2;this.getGameWindow()&&this.getGameWindow().playMoveArr(t,e,n)},t.prototype.playEventStep=function(e,n,o){console.info("playEventStep:",e,n,o);var i=this;this.waitClock.removeTimer("waitTurn"),this.waitClock.removeTimer("waitRollStep"+n),GameDebug==DebugType.OffLine&&this.waitClock.addTimer("waitRollStep"+n,2e3,function(e){i.gameLogic.roomInfo.gameInfos[n].state=3,t.instance().turnToSeatId(i.gameLogic.roomInfo.optIndex)});var r=this.gameLogic.setStep(n,o);this.getGameWindow()&&this.getGameWindow().map.moveToStep(n,r.step)},t.prototype.playerFinish=function(e){console.info("playerFinish:",e),this.waitClock.removeTimer("waitTurn"),this.waitClock.removeTimer("waitRollStep"+e);var n=this;this.gameLogic.setFinish(e),this.gameLogic.roomInfo.playerNum-this.gameLogic.finishCount==1&&this.preEndGame(),this.getGameWindow(),this.waitClock.addTimer("waitRollStep"+e,3e3,function(e){t.instance().turnToSeatId(n.gameLogic.roomInfo.optIndex)
})},t.prototype.onChat=function(t){if(t.msg.indexOf("[f:")>=0){var e=t.msg.substring(3,t.msg.length-1);this.getGameWindow()&&this.getGameWindow().showChatFace(t.seatid,e)}else{var e=t.msg;this.getGameWindow()&&this.getGameWindow().showChatMsg(t.seatid,e)}},t.prototype.setRoomInfo=function(e){console.info("设置玩家信息",e),t.instance().gameLogic.roomInfo.roomID=e.roominfo.roomID,t.instance().gameLogic.roomInfo.playerNum=e.roominfo.playerNum,t.instance().gameLogic.roomInfo.gameState=e.roominfo.gameState,t.instance().gameLogic.roomInfo.players=e.roominfo.players,t.instance().gameLogic.roomInfo.gameInfos=e.roominfo.gameInfos,t.instance().gameLogic.roomInfo.firstHandIdx=e.roominfo.firstHandIdx,t.instance().gameLogic.roomInfo.optIndex=e.roominfo.optIndex,t.instance().gameLogic.roomInfo.optCD=e.roominfo.optCD;for(var n=0;n<e.roominfo.players.length;n++){var o=e.roominfo.players[n];t.instance().gameLogic.playerEnter(o,o.id==UserManager.instance().getPlayerInfo().id,n);var i=e.roominfo.gameInfos[n].seatid;i==n?t.instance().playerEnter(n):console.error("error: 检查座位"),t.instance().gameLogic.roomInfo.gameState==GameState.gameing&&this.getGameWindow()&&this.getGameWindow().map.setStep(i,e.roominfo.gameInfos[n].nowStep)}e.roominfo.optIndex==t.instance().gameLogic.getMySeatId()&&1==e.roominfo.gameInfos[e.roominfo.optIndex].state&&this.getGameWindow().showOperationBD(e.roominfo.optIndex,!0)},t.prototype.pauseGame=function(){},t.prototype.resumeGame=function(){},t.prototype.reStartGame=function(){},t.prototype.getGameWindow=function(){return UIManager.instance().findWindow("GameWindow")?UIManager.instance().findWindow("GameWindow"):null},t.prototype.update=function(t){var e=t;this.timer;return this.timer=e,!1},t._instance=null,t}();__reflect(GameManager.prototype,"GameManager");var GameMessageCode=function(){function t(){}return t.SC_UserLogin="UserLogin",t.CS_UserLogin="UserLogin",t.SC_UpdatePlayerData="UpdatePlayerData",t.CS_UpdatePlayerData="UpdatePlayerData",t.CS_RomeLogin="RomeLogin",t.SC_RomeLogin="RomeLogin",t.CS_RomeLoguot="RomeLoguot",t.SC_RomeLoguot="RomeLoguot",t.CS_RoomInfo="RoomInfo",t.SC_RoomInfo="RoomInfo",t.CS_StartGame="StartGame",t.SC_StartGame="StartGame",t.CS_Operation="Operation",t.SC_Operation="Operation",t.CS_EndGame="EndGame",t.SC_EndGame="EndGame",t.CS_Chat="Chat",t.SC_Chat="Chat",t}();__reflect(GameMessageCode.prototype,"GameMessageCode");var GameNetwork=function(){function t(){this.connect_callback=null,this.heartTimer=-1,this.link=new NetSocket,this.initListener()}return Object.defineProperty(t,"Instance",{get:function(){return null==this.instance&&(this.instance=new t),this.instance},enumerable:!0,configurable:!0}),t.prototype.connect=function(t){this.link.connect(GameConfig.wsServer,GameConfig.port,this.onSocketHandler,this),this.connect_callback=t},t.prototype.close=function(){this.link.close()},t.prototype.initListener=function(){this.link.addListenerMessage(GameMessageCode.SC_UserLogin,this.recUserLogin,this),this.link.addListenerMessage(GameMessageCode.SC_UpdatePlayerData,this.recUpdatePlayerData,this),this.link.addListenerMessage(GameMessageCode.SC_RomeLogin,this.recRomeLogin,this),this.link.addListenerMessage(GameMessageCode.SC_RomeLoguot,this.recRomeLoguot,this),this.link.addListenerMessage(GameMessageCode.SC_RoomInfo,this.recRoomInfo,this),this.link.addListenerMessage(GameMessageCode.SC_StartGame,this.recStartGame,this),this.link.addListenerMessage(GameMessageCode.SC_Operation,this.recOperation,this),this.link.addListenerMessage(GameMessageCode.SC_EndGame,this.recEndGame,this),this.link.addListenerMessage(GameMessageCode.SC_Chat,this.recChat,this)},t.prototype.onSocketHandler=function(t){switch(t){case NetSocketStatus.Connected:this.connect_callback&&this.connect_callback();break;case NetSocketStatus.ConnectFailed:this.link.close(),console.info("连接失败，是否重连！");break;case NetSocketStatus.Disconnect:this.link.close(),this.closeHeart(),console.info("网络已断开，是否重连！");break;case NetSocketStatus.Error:this.link.close(),console.info("连接错误，是否重连！")}},t.prototype.sendHeart=function(t){var e=this;this.heartTimer=setTimeout(function(){e.link.send("Ping","")},t)},t.prototype.closeHeart=function(){clearTimeout(this.heartTimer)},t.prototype.requestLoginByWeb=function(t){t.type=LoginType.DEFAULT,t.acc="zh_test1",t.pw="1233456",t.inviteId=0,this.link.send(GameMessageCode.CS_UserLogin,JSON.stringify(t))},t.prototype.requestLoginByWeChat=function(t,e){t.type=GameLoginType,t.code=e,t.inviteId=0,this.link.send(GameMessageCode.CS_UserLogin,JSON.stringify(t))},t.prototype.requestLoginByFaceBook=function(t,e){t.type=LoginType.FACEBOOK,t.uid=parseInt(e.getID()),t.nickName=e.getName(),t.avatarUrl=e.getPhoto(),t.inviteId=0,this.link.send(GameMessageCode.CS_UserLogin,JSON.stringify(t))},t.prototype.recUserLogin=function(t){UserManager.instance().setUserInfo(JSON.parse(t)),this.requestUpdatePlayerData()},t.prototype.requestUpdatePlayerData=function(){var t=new CS_UpdatePlayerData;t.playerData=UserManager.instance().getPlayerInfo(),t.playerData.nickName=Math.random().toString(36).substr(2),t.playerData.gold=Number((1e3*Math.random()).toFixed(2)),t.playerData.gameTotalCount=Math.floor(1e3*Math.random()),this.link.send(GameMessageCode.CS_UpdatePlayerData,JSON.stringify(t))},t.prototype.recUpdatePlayerData=function(t){console.info("handleUpdatePlayerData:",t),UserManager.instance().updatePlayerInfo(JSON.parse(t)),UserManager.instance().isLogin||(UserManager.instance().isLogin=!0,MySceneManager.OnCreate().LoadMainScene(),UIManager.instance().openWindow("MainWindow"))},t.prototype.reqRomeLogin=function(t,e){var n=new CS_RomeLogin;n.type=GameManager.instance().type,n.roomid=t,e?n.playerData=e:n.playerData=UserManager.instance().getPlayerInfo(),this.link.send(GameMessageCode.CS_RomeLogin,JSON.stringify(n))},t.prototype.recRomeLogin=function(t){var e=new SC_RomeLogin;Util.safeCopy(e,JSON.parse(t));var n=e.roomid,o=e.playerData;if(o.id==UserManager.instance().getPlayerInfo().id&&GameManager.instance().gameLogic.roomInfo.gameState==GameState.matching&&GameManager.instance().matchingGame(),GameDebug==DebugType.OffLine){GameManager.instance().gameLogic.roomInfo.roomID=n;var i=GameManager.instance().gameLogic.playerEnter(o,o.id==UserManager.instance().getPlayerInfo().id,-1);return void GameManager.instance().playerEnter(i)}return 0>=n&&-1==e.status?(console.info("匹配失败了"),void GameManager.instance().endGame(!0)):void 0},t.prototype.reqRomeLoguot=function(t,e){var n=new CS_RomeLoguot;n.seatid=t,n.roomid=e,this.link.send(GameMessageCode.CS_RomeLoguot,JSON.stringify(n))},t.prototype.recRomeLoguot=function(t){var e=new SC_RomeLoguot;Util.safeCopy(e,JSON.parse(t)),e.seatid==GameManager.instance().gameLogic.getMySeatId()?GameManager.instance().endGame(!0):(GameManager.instance().gameLogic.roomInfo.gameInfos[e.seatid].state=10,console.info("退出房间 seatid:",e.seatid))},t.prototype.reqRoomInfo=function(t){var e=new CS_RoomInfo;e.roomid=t,this.link.send(GameMessageCode.CS_RomeLoguot,JSON.stringify(e))},t.prototype.recRoomInfo=function(e){var n=new SC_RoomInfo;Util.safeCopy(n,JSON.parse(e)),GameManager.instance().setRoomInfo(n),n.roominfo.gameState==GameState.matching?t.Instance.reqStartGame():GameManager.instance().recomeGame(),n.roominfo.gameState==GameState.firstHand},t.prototype.reqStartGame=function(){var t=new CS_StartGame;t.roomid=GameManager.instance().gameLogic.roomInfo.roomID,t.seatid=GameManager.instance().gameLogic.getMySeatId(),this.link.send(GameMessageCode.CS_StartGame,JSON.stringify(t))},t.prototype.recStartGame=function(t){var e=new SC_StartGame;Util.safeCopy(e,JSON.parse(t)),GameManager.instance().readyGame()},t.prototype.reqOperation=function(t,e){var n=new CS_Operation;n.roomid=GameManager.instance().gameLogic.roomInfo.roomID,n.rollNum=GameManager.instance().gameLogic.roll(),n.seatid=t,n.optType=e,this.link.send(GameMessageCode.CS_Operation,JSON.stringify(n))},t.prototype.recOperation=function(t){var e=new SC_Operation;Util.safeCopy(e,JSON.parse(t)),GameManager.instance().dealOperation(e)},t.prototype.recEndGame=function(t){var e=new SC_EndGame;Util.safeCopy(e,JSON.parse(t)),GameManager.instance().preEndGame()},t.prototype.reqChat=function(t){var e=new CS_Chat;e.roomid=GameManager.instance().gameLogic.roomInfo.roomID,e.msg=t,e.seatid=GameManager.instance().gameLogic.getMySeatId(),this.link.send(GameMessageCode.CS_Chat,JSON.stringify(e))},t.prototype.recChat=function(t){var e=new SC_Chat;Util.safeCopy(e,JSON.parse(t)),GameManager.instance().onChat(e)},t}();__reflect(GameNetwork.prototype,"GameNetwork");var MusicManager=function(){function t(){this.EffectStart=0,this.EffectLoop=0,this.isMuteMusic=!1,this.isMuteEffect=!1,this.effectList=new Array}return t.getInstance=function(){return t.Manager},t.prototype.StopMusic=function(){null!=this.Music&&this.Music.stop()},t.prototype.PlayMusic=function(t){this.StopMusic();var e=RES.getRes(t);null==e&&console.log("sound"+t+":::error"),e.type=egret.Sound.MUSIC,this.Music=e.play(0,0)},t.prototype.PlayEffect=function(t,e,n){if(!this.isMuteEffect){var o=RES.getRes(t);if(null==o)return void console.log("sound"+t+":::error");o.type=egret.Sound.EFFECT;var i=o.play(e,n);this.effectList.push(i),i.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)}},t.prototype.MuteMusic=function(){this.Music&&(this.Music.volume=0)},t.prototype.RestoreMusic=function(){this.Music&&(this.Music.volume=1)},t.prototype.MuteEffect=function(){for(var t=0;t<this.effectList.length;t++)this.effectList[t].volume=0},t.prototype.RestoreMuteEffect=function(){for(var t=0;t<this.effectList.length;t++)this.effectList[t].volume=1},t.prototype.onSoundComplete=function(t){},t.Manager=new t,t}();__reflect(MusicManager.prototype,"MusicManager");var MySceneManagerSingle=function(){function t(){this.onTouchstart=new Signa}return t.prototype.Clear=function(){this.onTouchstart.Clear()},t}();__reflect(MySceneManagerSingle.prototype,"MySceneManagerSingle",["SignaClear"]);var Scene=function(t){function e(e){var n=t.call(this)||this;if(n.Res="",n._Map=null,n._mySceneManagerSingle=null,e){var o=RES.getRes(e);new egret.Bitmap(o);n._Map=new Displayobj(new egret.Bitmap(o)),n._Map.SetTransform(n);var i=Util.getScreenCenterPos();n.SetPos(i[0],i[1]),n._Map.display.scaleX=1,n._Map.display.scaleY=egret.MainContext.instance.stage.stageHeight/1136*(egret.MainContext.instance.stage.stageWidth/640),LayerManager.Instance.removeForward(0),LayerManager.Instance.AddForward(n._Map.display,0),n._Map.display.touchEnabled=!0,n._Map.display.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.ontouchstart,n)}n._mySceneManagerSingle=SignaManger.Instance.One(MySceneManagerSingle);var r=SingletonFactory.InstanceT(SongSheetCsvManage).GetItem(0);return console.log("SongSheet:"+r.NAME),n}return __extends(e,t),e.prototype.ontouchstart=function(t){var e=this._camear.ScreenToWold(t.$stageX,t.$stageY);this._mySceneManagerSingle.onTouchstart.Send(e)},e.prototype.Destry=function(){this._Map.display.touchEnabled=!1,this._Map.display.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.ontouchstart,null)},e}(Gameobject);__reflect(Scene.prototype,"Scene");var MySceneManager=function(){function t(){this._mySceneManagerSingle=null,this.MScene=null,this.MCamera=null,this._mySceneManagerSingle=SignaManger.Instance.One(MySceneManagerSingle)}return t.OnCreate=function(){return t.Instance=new t,t.Instance},t.prototype.Create=function(t){return this.MCamera||(this.MCamera=new GameCamera),this.MScene||(this.MScene=new Scene(t)),this.MScene},t.prototype.LoadMainScene=function(){UIManager.instance().removeAllWindow();t.Instance.Create("bg_03_png")},t.prototype.LoadGameScene=function(){UIManager.instance().removeAllWindow();t.Instance.Create("bg_03_png")},t.prototype.onkeydown=function(t){console.log(t.data)},t}();__reflect(MySceneManager.prototype,"MySceneManager");var ServiceListManager=function(){function t(){this.serviceAry=[]}return t.instance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.updateServiceList=function(t){if(this.serviceAry=[],t)for(var e=0,n=t;e<n.length;e++){var o=n[e];this.serviceAry.push(JSON.parse(o))}},t.prototype.getServiceDataByid=function(t){if(!(this.serviceAry.length>0))return null;for(var e=0;this.serviceAry.length;e++)if(this.serviceAry[e].ser_id===t)return this.serviceAry[e]},t.prototype.getDefaultServiceListData=function(){return this.serviceAry.length>0?this.serviceAry[0]:null},t.prototype.getServiceAry=function(){return this.serviceAry},t._instance=null,t}();__reflect(ServiceListManager.prototype,"ServiceListManager");var ShopBagType;!function(t){t[t.emojis=0]="emojis",t[t.piece=1]="piece",t[t.gold=2]="gold"}(ShopBagType||(ShopBagType={}));var ShoppingType;!function(t){t[t.emojiSuccess=0]="emojiSuccess",t[t.emojiFailed=1]="emojiFailed",t[t.goldSuccess=2]="goldSuccess",t[t.goldFailed=3]="goldFailed"}(ShoppingType||(ShoppingType={}));var ShopManager=function(){function t(){this.emojisBag=null,this.goldBag=null,this.curShopBagType=null,this.shoppingItemInfo=new ShoppingItemInfo,this.shopHasMap=new HashMap}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.getEmojisBag=function(){return this.emojisBag},t.prototype.getGoldBag=function(){return this.goldBag},t.prototype.initAllBag=function(){null===this.emojisBag&&(this.emojisBag=new HashMap,this.goldBag=new HashMap)},t.prototype.clearAllBag=function(){null!=this.emojisBag&&(this.emojisBag.clear(),this.goldBag.clear())},t.prototype.getShopBagByType=function(t){switch(t){case ShopBagType.emojis:case ShopBagType.piece:return this.emojisBag;case ShopBagType.gold:return this.goldBag;default:return this.emojisBag}},t.prototype.getPackList=function(t){var e=this;this.initAllBag(),this.clearAllBag(),t.map(function(t,n){var o=t.type;switch(o){case ShopBagType.emojis:case ShopBagType.piece:e.emojisBag.put(n,t);break;case ShopBagType.gold:e.goldBag.put(n,t)}});this.emojisBag,this.goldBag},t.prototype.getIconArray=function(t){for(var e=0;e<this.shopHasMap.size();e++)if(parseInt(t)==this.shopHasMap.getValue(e).id)return this.shopHasMap.getValue(e);return null},t.prototype.getShopItemDataFromJson=function(){var t=RES.getRes("ShopConfig_json"),e=t.emojis,n=t.piece,o=t.gold,i=[];return i=i.concat(e,n,o)},t.prototype.initAllShopItemData=function(t){for(var e=null,n=0;n<t.length;n++){null==this.shopHasMap.getValue(t[n].id)&&(e=new ShoppingItemInfo,e.shopdataArr=[],this.shopHasMap.put(this.shopHasMap.size(),e)),e.id=t[n].id,e.itemType=t[n].type,e.name=t[n].itemName,e.sourceName=t[n].gropname+"_json."+t[n].name,e.price=0,e.shopdataArr.push({icoId:t[n].id,itemIco:e.sourceName,type:"local"});this.shopHasMap}},t.prototype.getShopItemRendererData=function(){for(var t=[],e=this.shopHasMap.size(),n=0;e>n;n++){var o=this.shopHasMap.getValue(n);switch(o.itemType){case ShopBagType.emojis:case ShopBagType.piece:t.push({type:o.itemType,id:o.id,itemName:o.name,itemArr:o.shopdataArr,gold:2e3});break;case ShopBagType.gold:t.push({type:ShopBagType.gold,id:o.id,goldCount:o.name,itemIco:o.sourceName,money:2e3})}}return t},t._instance=null,t}();__reflect(ShopManager.prototype,"ShopManager");var UserManager=function(){function t(){this.isLogin=!1,this._userInfo=new UserInfo,this._playerInfo=new PlayerInfo,this._curPlayerInfo=null}return t.instance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.setUserInfo=function(t){Util.safeCopy(this._userInfo,t.userData),Util.safeCopy(this._playerInfo,t.playerData),console.log("设置用户数据:UserManager")},t.prototype.getUserInfo=function(){return this._userInfo},t.prototype.getPlayerInfo=function(){return this._playerInfo},t.prototype.updatePlayerInfo=function(t){Util.safeCopy(this._playerInfo,t.playerData)},t.prototype.getCurPlayerInfo=function(){return this._curPlayerInfo?this._curPlayerInfo:this._playerInfo},t.prototype.setCurPlayerInfo=function(t){this._curPlayerInfo=t},t._instance=null,t}();__reflect(UserManager.prototype,"UserManager");var ClockItem=function(){function t(){this.id=0,this.time=0,this.call=null,this.ext={}}return t}();__reflect(ClockItem.prototype,"ClockItem");var Clock=function(){function t(){this.timers={},this.isRun=!1,this.timers={},this.isRun=!1}return t.prototype.start=function(){this.isRun=!0},t.prototype.stop=function(){this.isRun=!1},t.prototype.addTimer=function(t,e,n){var o=this;return new Promise(function(i,r){var a=new ClockItem;a.call=n,a.time=e,a.ext=t,a.id=setTimeout(function(){o.isRun?i(a):r(a)},a.time),o.timers[t]=a}).then(function(t){clearTimeout(t.id),t.call(t.ext)})["catch"](function(t){console.info("Clock is stop"),clearTimeout(t.id)})},t.prototype.removeTimer=function(t){this.timers[t]&&(clearTimeout(this.timers[t].id),delete this.timers[t])},t.prototype.removeAllTimer=function(){for(var t in this.timers)this.removeTimer(t)},t}();__reflect(Clock.prototype,"Clock");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.MainContext.instance.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){},UserProto.instance().registerProtocol(),egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var e=new InitSdkHandel;e.success=function(){console.log("start game"),platform.getEntryPointData().then(function(t){console.info(t),t&&t.inviteRomeId&&console.info("我要加入房间：",t.inviteRomeId)}),platform.getContext().then(function(t){console.info("当前游戏环境:",t.getID(),t.getType(),t.getPlayersAsync())})},e.fail=function(t){console.log(t)},platform.initSdk(e),LayerManager.OnCreate(),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),[4,platform.login()];case 2:return e.sent(),t=this,GameDebug!=DebugType.OffLine?[3,4]:[4,platform.getUserInfo().then(function(e){console.info("platform userInfo:",e),"undefined"!=typeof FBInstant?GameNetwork.Instance.requestLoginByFaceBook(new CS_UserLogin,e):window.wx||GameNetwork.Instance.requestLoginByWeb(new CS_UserLogin),t.createGameScene()})];case 3:return e.sent(),[3,6];case 4:return[4,platform.getUserInfo().then(function(e){console.info("platform userInfo:",e),GameNetwork.Instance.connect(function(){"undefined"!=typeof FBInstant?GameNetwork.Instance.requestLoginByFaceBook(new CS_UserLogin,e):window.wx||GameNetwork.Instance.requestLoginByWeb(new CS_UserLogin)}),t.createGameScene()})];case 5:e.sent(),e.label=6;case 6:return[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("loading")];case 2:return n.sent(),t=UIManager.instance().openWindow("LoadingWindow"),[4,this.loadTheme()];case 3:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 4:return n.sent(),[3,6];case 5:return e=n.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var o=new eui.Theme("resource/default.thm.json",t.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e.prototype.startAnimation=function(t){var e=this,n=new egret.HtmlTextParser,o=t.map(function(t){return n.parse(t)}),i=this._textfield,r=-1,a=function(){r++,r>=o.length&&(r=0);var t=o[r];i.textFlow=t;var n=egret.Tween.get(i);n.to({alpha:1},200),n.wait(2e3),n.to({alpha:0},200),n.call(a,e)};a()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var GameMapStepLen=48,GameMapEvents={0:{name:"start",toIndex:0},1:{name:"tree",toIndex:0},7:{name:"ladder",toIndex:19},17:{name:"ladder",toIndex:29},20:{name:"snake",toIndex:1},24:{name:"ladder",toIndex:41},27:{name:"ladder",toIndex:38},30:{name:"snake",toIndex:12},36:{name:"snake",toIndex:19},46:{name:"snake",toIndex:25},47:{name:"destination",toIndex:0}},BagProto=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.instance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.requestGetPackageList=function(t){HttpHandler.instance().sendLoginMessage(t)},e.prototype.handleGetPackageList=function(t){BagManager.instance().getPackList(t)},e.prototype.failGetPackageList=function(t){},e.prototype.registerProtocol=function(){HttpHandler.instance().registerProtocol("GetPackageList",this)},e._instance=null,e}(ProtoBase);__reflect(BagProto.prototype,"BagProto");var GameProto=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.instance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.requestRomeLogin=function(t){t.type=GameType.test},e.prototype.failRomeLogin=function(t){},e.prototype.handleRomeLogin=function(t){},e.prototype.registerProtocol=function(){},e._instance=null,e}(ProtoBase);__reflect(GameProto.prototype,"GameProto");var QualityColor;!function(t){t[t.White=7435091]="White",t[t.Green=1271403]="Green",t[t.Blue=1593986]="Blue",t[t.Red=11544255]="Red",t[t.Orange=9910326]="Orange"}(QualityColor||(QualityColor={}));var EventType;!function(t){t[t.test1=1]="test1",t[t.test2=2]="test2",t[t.updateBagWindow=3]="updateBagWindow"}(EventType||(EventType={}));var GameType;!function(t){t[t.test=1]="test",t[t.normalMode=2]="normalMode",t[t.matchingMode=3]="matchingMode",t[t.firendMode=4]="firendMode"}(GameType||(GameType={}));var GameState;!function(t){t[t.matching=1]="matching",t[t.gameStart=2]="gameStart",t[t.firstHand=3]="firstHand",t[t.gameing=4]="gameing",t[t.gameEnd=5]="gameEnd"}(GameState||(GameState={}));var OperationType;!function(t){t[t.firstHandRoll=1]="firstHandRoll",t[t.rollStep=2]="rollStep"}(OperationType||(OperationType={}));var HeadIconType;!function(t){t[t.headIcon=0]="headIcon",t[t.gameIcon=1]="gameIcon",t[t.gameIconOne=2]="gameIconOne"}(HeadIconType||(HeadIconType={}));var selectScan="selectScan",UserProto=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.instance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.requestUserLogin=function(t){t.type=GameLoginType,HttpHandler.instance().sendLoginMessage(t)},e.prototype.requestLoginByWeb=function(t){return t.type=LoginType.USERNAME,t.acc="张辉",t.pw="1233456",t.inviteId=0,GameDebug==DebugType.OffLine?(UserManager.instance().getPlayerInfo().nickName="123",UserManager.instance().getPlayerInfo().avatarUrl="https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83erUbNicL4RicqD50sFfian0CRH9AkMbicN5q8YhaTeC4df8aG8MPkiaNwK8vM36f7OTppH2SdZOlpkTUvA/132",MySceneManager.OnCreate().LoadMainScene(),void UIManager.instance().openWindow("MainWindow")):void HttpHandler.instance().sendLoginMessage(t)},e.prototype.requestLoginByWeChat=function(t,e){t.type=GameLoginType,t.code=e,t.inviteId=0,HttpHandler.instance().sendLoginMessage(t)},e.prototype.requestLoginByFaceBook=function(t,e){return t.type=LoginType.FACEBOOK,t.uid=parseInt(e.getID()),t.nickName=e.getName(),t.avatarUrl=e.getPhoto(),t.inviteId=0,GameDebug==DebugType.OffLine?(UserManager.instance().getPlayerInfo().nickName=e.getName(),UserManager.instance().getPlayerInfo().avatarUrl=e.getPhoto(),UserManager.instance().getPlayerInfo().id=parseInt(e.getID()),MySceneManager.OnCreate().LoadMainScene(),void UIManager.instance().openWindow("MainWindow")):void HttpHandler.instance().sendLoginMessage(t)},e.prototype.handleUserLogin=function(t){UserManager.instance().setUserInfo(t),this.requestUpdatePlayerData()},e.prototype.failUserLogin=function(t){},e.prototype.requestUpdatePlayerData=function(){var t=new CS_UpdatePlayerData;t.playerData=UserManager.instance().getPlayerInfo(),t.playerData.gold=998,t.playerData.gameTotalCount=999,HttpHandler.instance().sendLoginMessage(t)},e.prototype.handleUpdatePlayerData=function(t){console.info("handleUpdatePlayerData:",t),UserManager.instance().updatePlayerInfo(t),UserManager.instance().isLogin||(UserManager.instance().isLogin=!0,MySceneManager.OnCreate().LoadMainScene(),UIManager.instance().openWindow("MainWindow"))},e.prototype.failUpdatePlayerData=function(t){},e.prototype.registerProtocol=function(){},e._instance=null,e}(ProtoBase);__reflect(UserProto.prototype,"UserProto");var ErrorLang={};ErrorLang[0]="未知错误",ErrorLang[1]="操作成功",ErrorLang[2]="登录失效，请重新登录",ErrorLang[3]="登录错误",ErrorLang[4]="登录过期",ErrorLang[5]="失去连接，重登",ErrorLang[101]="功能关闭",ErrorLang[102]="保存失败",ErrorLang[103]="加载失败",ErrorLang[104]="无效JSON数据",ErrorLang[105]="无效验证码",ErrorLang[106]="微信登录失败";var Help=function(){function t(){}return t.ArrayRemove=function(t,e){var n=t.indexOf(e);return n>-1?(t.splice(n,1),!0):!1},t.Lerp=function(t,e,n){return t*(1-n)+e*n},t.GetRandomInt=function(t,e){var n=e-t,o=Math.random();return t+Math.round(o*n)},t.GetRandom=function(t,e){var n=e-t,o=Math.random();return t+o*n},t}();__reflect(Help.prototype,"Help");var StringHelp=function(){function t(){}return t.IsEmpty=function(t){return void 0==t?!0:null==t?!0:""==t?!0:!1},t.Format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o=0;10>o;o++){var i="{"+o+"}";if(-1==t.indexOf(i))break;var r=String(e[o]);t=t.replace(i,r)}return t},t}();__reflect(StringHelp.prototype,"StringHelp");var DebugShapeRect=function(){function t(t){this.Obj=null,this.ShapeRect=null,this.Obj=t,this.ShapeRect=new egret.Shape,t.stage.addChild(this.ShapeRect)}return t.prototype.Synchronization=function(){this.ShapeRect.anchorOffsetX=this.Obj.anchorOffsetX,this.ShapeRect.anchorOffsetY=this.Obj.anchorOffsetY,this.ShapeRect.x=this.Obj.x,this.ShapeRect.y=this.Obj.y,this.ShapeRect.width=this.Obj.width,this.ShapeRect.height=this.Obj.height,this.ShapeRect.skewX=this.Obj.skewX,this.ShapeRect.skewY=this.Obj.skewY,this.ShapeRect.scaleX=this.Obj.scaleX,this.ShapeRect.scaleY=this.Obj.scaleY},t.prototype.drawCircle=function(t){this.Synchronization();var e=this.ShapeRect;e.graphics.beginFill(16711680),e.graphics.drawCircle(e.anchorOffsetX,e.anchorOffsetY,t),e.graphics.endFill()},t.prototype.drawRect=function(t,e){this.Synchronization();var n=this.ShapeRect;t||(t=n.width),e||(e=n.height),n.graphics.beginFill(102,1),n.graphics.drawRect(n.anchorOffsetX,n.anchorOffsetY,t,e),n.graphics.endFill()},t}();__reflect(DebugShapeRect.prototype,"DebugShapeRect");var DebugDisplay=function(){function t(t){this.ShapeRect=null,this.ShapeAnchor=null,this.ShapeRect=new DebugShapeRect(t),this.ShapeAnchor=new DebugShapeRect(t),this.DrawDebug()}return t.prototype.DrawDebug=function(){this.ShapeRect.drawRect(),this.ShapeAnchor.drawCircle(10)},t}();__reflect(DebugDisplay.prototype,"DebugDisplay");var MyDebug=function(){function t(){}return t.AddDisplayArray=function(e){t.DisplayArray.push(new DebugDisplay(e)),t._sUpdate.Start(t.Update)},t.Update=function(){for(var e=0,n=t.DisplayArray;e<n.length;e++){var o=n[e];o.DrawDebug()}},t._sUpdate=new UpdateObj(1),t.DisplayArray=new Array,t}();__reflect(MyDebug.prototype,"MyDebug");var GameConfig={};GameConfig.loginUrl="http://192.168.1.107:8201/",GameConfig.gameUrl="http://127.0.0.1:8202/",GameConfig.assetUrl="http://127.0.0.1:7000/",GameConfig.wsServer="192.168.1.107",GameConfig.port=8200;var LoginType;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.USERNAME=1]="USERNAME",t[t.WECHAT=2]="WECHAT",t[t.FACEBOOK=3]="FACEBOOK"}(LoginType||(LoginType={}));var GameLoginType=LoginType.FACEBOOK,DebugType;!function(t){t[t.OnLine=1]="OnLine",t[t.OffLine=2]="OffLine"}(DebugType||(DebugType={}));var GameDebug=DebugType.OnLine,Utils=function(){function t(){}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.buttonEffect=function(t,e,n,o){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){var e=egret.Tween.get(t);if(e.to({scaleX:1.1,scaleY:1.1},100),o){var n=egret.Tween.get(o);n.to({scaleX:1.1,scaleY:1.1},100)}},n),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var i=egret.Tween.get(t);if(i.to({scaleX:1,scaleY:1},100),o){var r=egret.Tween.get(o);r.to({scaleX:1,scaleY:1},100)}e.apply(n)},n),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){var e=egret.Tween.get(t);if(e.to({scaleX:1,scaleY:1},100),o){var n=egret.Tween.get(o);n.to({scaleX:1,scaleY:1},100)}},this)},t}();__reflect(Utils.prototype,"Utils");var TestWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/TestSkin.exml"},e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.showRoleWing(0)},e.prototype.playDragonEff=function(){this.loadChibangByResName("backman_json")},e.prototype.loadChibangByResName=function(t){var e=this;RES.getResAsync(t,function(t,n){"Robot_json"==n?e.loadChibangByResName("texture_json"):"texture_json"==n?e.loadChibangByResName("texture_png"):"texture_png"==n&&this.showRoleWing()},this)},e.prototype.showRoleWing=function(t){this.egretFactory=DragonBoneManager.instance().createDragonByName("backman");var e=this.egretFactory.buildArmatureDisplay("armatureName");this.addChild(e),e.animation.play("animation",0),e.x=250,e.y=300},e}(UIWindow);__reflect(TestWindow.prototype,"TestWindow");var ClassifyCellWidget=function(t){function e(){var e=t.call(this)||this;return e.onInit(),e}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/widgetSkins/ClassifyCellWidget.exml"},e.prototype.setData=function(t){this.data=t,this.cell_name.source=UIManager.instance().getSourceNameByAtlasAndName("FontIcon",t.nameSource),this.type_icon.source=UIManager.instance().getSourceNameByAtlasAndName("Item",t.iconSource)},e.prototype.getData=function(){return this.data},e}(eui.RadioButton);__reflect(ClassifyCellWidget.prototype,"ClassifyCellWidget",["UIWidget"]);var ClassifyWindowItem=function(t){function e(){var e=t.call(this)||this;return e.onInit(),e}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/widgetSkins/ClassifyWindowItem.exml",this.selectedIcon.visible=!1},e.prototype.dataChanged=function(){},e.prototype.setSelected=function(){this.selectedIcon.visible=!0},e}(eui.ItemRenderer);__reflect(ClassifyWindowItem.prototype,"ClassifyWindowItem",["UIWidget"]);var GuildToggleBtn=function(t){function e(){var e=t.call(this)||this;return e.atlasName="Login",e.skinName="resource/eui_skins/widgetSkins/GuildBtnWidget.exml",e}return __extends(e,t),e.prototype.onInit=function(){},e.prototype.setImg=function(t,e){this.color.source=UIManager.instance().getSourceNameByAtlasAndName(this.atlasName,t),this.gray.source=UIManager.instance().getSourceNameByAtlasAndName(this.atlasName,e)},e}(eui.ToggleButton);__reflect(GuildToggleBtn.prototype,"GuildToggleBtn",["UIWidget"]);var HeadIconWidget=function(t){function e(){var e=t.call(this)||this;return e.head_shape=null,e.scale=1,e.scale_img=1,e.touchEvent=null,e.type=0,e.playerInfo=new PlayerInfo,e.headType=HeadIconType.headIcon,e.imgTexture=null,e.headIconIndex=null,e.skinName="HeadIconWidgetSkin",e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchCallBack,e),e.head_shape=new egret.Shape,e.addChildAt(e.head_shape,0),e.head_img.mask=e.head_shape,e}return __extends(e,t),e.prototype.setTouchCallBack=function(t){this.touchEvent=t},e.prototype.setNameVisiable=function(t){this.head_name.alpha=t?1:0},e.prototype.setNameColor=function(t){this.head_name.textColor=t},e.prototype.touchCallBack=function(t){this.touchEvent&&this.touchEvent(this.data)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)
},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),console.info("HeadIconWidget refresh:",this.data),this.data.scale&&this.setScale(this.data.scale),this.data.scale_img&&this.setScaleImg(this.data.scale_img),this.data.playerInfo&&(this.playerInfo=this.data.playerInfo,this.playerInfo.id==UserManager.instance().getPlayerInfo().id&&this.setNameColor(4480932)),this.data.event&&this.setTouchCallBack(this.data.event),this.data.headType&&(this.headType=this.data.headType,this.headIconIndex=this.data.headIconIndex,this.imgTexture=ConfigInfo.myScansHasMap.getValue(this.headIconIndex)),this.refresh(),0==this.type&&this.drawHeadImgRectRound()},e.prototype.setScale=function(t){this.scale=t,this.scaleX=t,this.scaleY=t},e.prototype.setScaleImg=function(t){this.scale_img=t,this.head_img.scaleX=t,this.head_img.scaleY=t,this.head_kuang.scaleX=t,this.head_kuang.scaleY=t},e.prototype.drawHeadImgRectRound=function(){this.head_shape&&(this.head_shape.graphics.clear(),this.head_shape.graphics.beginFill(14249574,1),this.head_shape.graphics.lineStyle(1,14249574,1),this.head_shape.graphics.drawRoundRect(0,0,(this.head_kuang.width-3)*this.scale_img,(this.head_kuang.height-3)*this.scale_img,20,20),this.head_shape.graphics.endFill(),this.head_shape.x=1.5+(1-this.scale_img)*this.head_kuang.width/2,this.head_shape.y=(1-this.scale_img)*this.head_kuang.height/2)},e.prototype.refresh=function(){var t=this;switch(this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.head_name.text=this.playerInfo.nickName,this.headType){case HeadIconType.headIcon:if(this.playerInfo.avatarUrl){var e=this;this.loadHttpIcon({success:function(){console.info("refresh icon img.",e.playerInfo.nickName)}})}break;case HeadIconType.gameIcon:var n=this.playerInfo.selectScan;this.head_img.texture=ConfigInfo.myScansHasMap.getValue(n);break;case HeadIconType.gameIconOne:this.head_img.source=this.imgTexture,this.setNameVisiable(!1),this.head_img.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){EventManager.instance().dispatchEvent(GameEvents.CHANGE_PLAYER_SKIN,t.headIconIndex),console.log(t.head_img)},this)}},e.prototype.loadHttpIcon=function(t){var e=this,n=new egret.ImageLoader;n.crossOrigin="anonymous",n.load(this.playerInfo.avatarUrl),n.once(egret.Event.COMPLETE,function(n){if(n.currentTarget.data){var o=new egret.Texture;o.bitmapData=n.currentTarget.data,e.head_img.texture=o,t.success()}},this)},e}(eui.ItemRenderer);__reflect(HeadIconWidget.prototype,"HeadIconWidget");var ItemCellWidget=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/widgetSkins/ItemCellWidget.exml",this.dataChanged()},e.prototype.dataChanged=function(){},e}(eui.ItemRenderer);__reflect(ItemCellWidget.prototype,"ItemCellWidget",["UIWidget"]);var MacthLoading=function(t){function e(){var e=t.call(this)||this;return e.skinName=MacthLoadingSkin,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.loading.setCallBack(function(){console.info("匹配结束")}),this.loading.addTouchEvent(),this.loading.startTime(GameManager.instance().MatchingTime/1e3),GameManager.instance().type==GameType.firendMode?this.tip.text="Waiting for firends ...":GameManager.instance().type==GameType.matchingMode?this.tip.text="Matching other players ...":this.tip.text="Matching computers ..."},e.prototype.onTweenGroupComplete=function(){},e}(eui.Component);__reflect(MacthLoading.prototype,"MacthLoading");var MyButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/widgetSkins/MyButton.exml",e.registerBtnEvent(),e.init(),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setImgScore=function(t){var e=this.btn.getChildAt(0);e.source=RES.getRes(t),e.smoothing=!0},e.prototype.getLabel=function(){return this.btn.labelDisplay},e.prototype.init=function(){this.group.width=0,this.group.height=0,this.getLabel().text="",this.getLabel().fontFamily="hydsf",this.getLabel().size=40,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2},e.prototype.registerBtnEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.scaleBeginZoom,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.scaleEndZoom,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.scaleEndZoom,this)},e.prototype.scaleBeginZoom=function(t){this.scaleTo.play(0)},e.prototype.scaleEndZoom=function(t){this.scaleBack.play(0)},e}(eui.Button);__reflect(MyButton.prototype,"MyButton");var ProgressBarWidget=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/widgetSkins/ProgressBarWidget.exml",e.forward.mask=e.forwardMask,e}return __extends(e,t),e.prototype.onInit=function(){},e.prototype.setBarImg=function(t,e){this.background.source=t,this.forward.source=e},e.prototype.setProgress=function(t){t>1?t=1:0>t&&(t=0),this.forwardMask=new egret.Rectangle(0,0,this.width*t,this.height),this.forward.mask=this.forwardMask},e}(eui.Component);__reflect(ProgressBarWidget.prototype,"ProgressBarWidget",["UIWidget"]);var RoleTopInfoWidget=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/widgetSkins/RoleTopInfo.exml",this.playerInfo=UserManager.instance().getPlayerInfo(),this.registerBtnEvent(),this.initWindow()},e.prototype.initWindow=function(){if(null==ConfigInfo.myScansHasMap){if("string"==typeof this.playerInfo.myScans){for(var t=this.playerInfo.myScans,e=t.split(","),n=[],o=0;o<e.length;o++)n.push(parseInt(e[o]));if(this.playerInfo.myScans=n.slice(),t.length<=0){for(var o=1;5>o;o++)this.playerInfo.myScans.push(o);GameNetwork.Instance.requestUpdatePlayerData()}}else if(0==this.playerInfo.myScans.length){for(var o=1;5>o;o++)this.playerInfo.myScans.push(o);GameNetwork.Instance.requestUpdatePlayerData()}ConfigInfo.myScansHasMap=new HashMap;var i=RES.getRes("HeadIconTest_json"),r=i._textureMap;for(var a in r){var t=a.slice(4),s=parseInt(t);ConfigInfo.myScansHasMap.put(s,r[a])}this.playerInfo.selectScan=1}this.lab_nickName.text=this.playerInfo.nickName,this.lab_gold.text=this.playerInfo.gold.toString(),console.log("RoleTopInfo"+this.playerInfo.nickName),this.btn_setting.setImgScore("Common_json.icon_SET"),this.btn_shop.setImgScore("Common_json.icon_+");var c=this;this.head_icon.setNameVisiable(!1),this.head_icon.data={playerInfo:this.playerInfo,event:function(t){c.OnClickToRoleInfo(t.playerInfo)}}},e.prototype.registerBtnEvent=function(){var t=this;this.btn_shop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickEnterShop,this),this.btn_setting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickSetting,this),EventManager.instance().addEventListener(GameEvents.PlayerGoldUIUpdate,function(e){t.lab_gold.text=e},this)},e.prototype.OnClickToRoleInfo=function(t){console.log("打开个人信息！"),UserManager.instance().setCurPlayerInfo(this.playerInfo),UIManager.instance().openWindow("RoleHeadInfoWindow")},e.prototype.clickEnterShop=function(t){UIManager.instance().findWindow("ShopWindow")||(console.log("打开商店"),UIManager.instance().openWindow("ShopWindow"))},e.prototype.onClickSetting=function(){console.log("打开游戏设置界面"),UIManager.instance().openWindow("SettingWindow")},e.prototype.closeRoleHeadInfo=function(){console.log("关闭界面"),UIManager.instance().closeWindow("RoleHeadInfoWindow")},e.prototype.testData=function(){var t=ShopManager.instance().getShopItemDataFromJson();ShopManager.instance().initAllShopItemData(t);var e=ShopManager.instance().getShopItemRendererData();ShopManager.instance().getPackList(e)},e}(UIWindow);__reflect(RoleTopInfoWidget.prototype,"RoleTopInfoWidget");var SelectServiceBtn=function(t){function e(){var e=t.call(this)||this;return e.onInit(),e}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/widgetSkins/SelectServiceBtn.exml",this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.click,this)},e.prototype.dataChanged=function(){this.ser_name.text=this.data.ser_name,this.isNew.visible=1===this.data.ser_isNew},e.prototype.click=function(){UIManager.instance().findWindow("LoginWindow"),UIManager.instance().closeWindow("SelecteServiceWindow")},e}(eui.ItemRenderer);__reflect(SelectServiceBtn.prototype,"SelectServiceBtn",["UIWidget"]);var SelectServiceToggleBtn=function(t){function e(){var e=t.call(this)||this;return e.onInit(),e}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/widgetSkins/SelectServiceToggleBtn.exml"},e.prototype.setLabel=function(t){this.ser_area.text=t},e}(eui.ToggleButton);__reflect(SelectServiceToggleBtn.prototype,"SelectServiceToggleBtn",["UIWidget"]);var ShopItemGold=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/eui_skins/widgetSkins/ShopItemGoldWidget.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ShopingGoods,this),this.buy_btn.setImgScore("Common_json.button_blue_l"),this.gro_buy.touchChildren=!0,this.gro_buy.touchThrough=!0,this.gro_buy.getChildAt(1).touchEnabled=!1,this.gro_buy.getChildAt(2).touchEnabled=!1,this.buy_btn.touchEnabled=!0},e.prototype.dataChanged=function(){var t=ShopManager.instance().getIconArray(this.buy_btn.label);t?this.itemIco.source=t.sourceName:console.log("ShopItemGold获取商品图片失败！")},e.prototype.ShopingGoods=function(){console.log("跳转到支付页面购买物品!")},e}(eui.ItemRenderer);__reflect(ShopItemGold.prototype,"ShopItemGold");var ShopItemList=function(t){function e(){var e=t.call(this)||this;return e.shopManager=ShopManager.instance(),e.skinName="resource/eui_skins/widgetSkins/ShopItemWidget.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ShopingGoods,this),this.buy_btn.setImgScore("Common_json.button_blue_l"),this.gro_buy.touchChildren=!0,this.gro_buy.touchThrough=!0,this.gro_buy.getChildAt(1).touchEnabled=!1,this.gro_buy.getChildAt(2).touchEnabled=!1,this.buy_btn.touchEnabled=!0},e.prototype.showShopItemIcon=function(t){for(var e=(this.itemName.text,new eui.ArrayCollection),n=t.length,o=0;n>o;o++){var i=t[o].itemIco,r=t[o].type,a=t[o].icoId;e.addItem({itemIcoType:r,itemIcoId:a,source:i})}this.shopItemIcoList.dataProvider=e,this.shopItemIcoList.itemRenderer=ShopItemIcos},e.prototype.ShopingGoods=function(){console.log("购买物品"+this.itemName.text+"_金币:"+this.buy_goldcount.text+"ico:"+this.buy_btn.label),this.shopManager.shoppingItemInfo.id=parseInt(this.buy_btn.label),this.shopManager.shoppingItemInfo.name=this.itemName.text,this.shopManager.shoppingItemInfo.price=parseInt(this.buy_goldcount.text);var t=this.shopManager.getIconArray(this.shopManager.shoppingItemInfo.id.toString()),e=UserManager.instance().getPlayerInfo();if(e.gold>=parseInt(this.buy_goldcount.text)){switch(e.gold-=this.shopManager.shoppingItemInfo.price,EventManager.instance().dispatchEvent(GameEvents.PlayerGoldUIUpdate,e.gold.toString()),t.itemType){case ShopBagType.emojis:e.myEmoticons.push(this.shopManager.shoppingItemInfo.id);break;case ShopBagType.piece:e.myScans.push(this.shopManager.shoppingItemInfo.id)}GameNetwork.Instance.requestUpdatePlayerData(),this.shopManager.shoppingItemInfo.type=ShoppingType.emojiSuccess,UIManager.instance().openWindow("ShoppinInfoWidget")}else this.shopManager.shoppingItemInfo.type=ShoppingType.emojiFailed,UIManager.instance().openWindow("ShoppinInfoWidget")},e.prototype.dataChanged=function(){var t=this.shopManager.getIconArray(this.buy_btn.label);t?this.showShopItemIcon(t.shopdataArr):console.log("ShopItemList获取商品图片失败！")},e}(eui.ItemRenderer);__reflect(ShopItemList.prototype,"ShopItemList");var ShopItemIcos=function(t){function e(){var e=t.call(this)||this;return e.itemIcoType=null,e.skinName="resource/eui_skins/widgetSkins/ShopItemEmojis.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.itemIcoType&&(this.itemIcoType=this.data.itemIcoType,"local"==this.itemIcoType?this.img_itemIco.source=this.data.source:this.loadHttpIcon(this.data.source))},e.prototype.loadHttpIcon=function(t){var e=this,n=new egret.ImageLoader;n.crossOrigin="anonymous",n.load(t),n.once(egret.Event.COMPLETE,function(t){if(t.currentTarget.data){var n=new egret.Texture;n.bitmapData=t.currentTarget.data,e.img_itemIco.texture=n}},this)},e}(eui.ItemRenderer);__reflect(ShopItemIcos.prototype,"ShopItemIcos");var ShoppinInfoWidget=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){this.skinName="resource/eui_skins/widgetSkins/ShoppinInfo.exml",this.initWindow(),this.btn_confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeWindow,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeWindow,this),this.btn_confirm.setImgScore("Common_json.button_green_l"),this.btn_confirm.getLabel().text="Confirm",this.btn_close.setImgScore("Common_json.icon_x")},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.initWindow=function(){var t=ShopManager.instance().shoppingItemInfo;switch(t.type){case ShoppingType.emojiSuccess:this.lab_content.text=t.name+" emoji was purchased successfully!",this.lab_content.textAlign=egret.HorizontalAlign.CENTER,this.lab_content.lineSpacing=15,this.img_title.source="Common_json.font_succ",this.im_image.source="";break;case ShoppingType.emojiFailed:this.lab_content.text="Your balance is not enough, please recharge and purchase!",this.lab_content.textAlign=egret.HorizontalAlign.CENTER,this.lab_content.lineSpacing=15,this.img_title.source="Common_json.font_fail",this.im_image.source="";break;case ShoppingType.goldSuccess:this.lab_content.text="Successful purchase "+t.price+"apples",this.lab_content.textAlign=egret.HorizontalAlign.CENTER,this.lab_content.lineSpacing=15,this.img_title.source="Common_json.font_succ",this.im_image.source="";break;case ShoppingType.goldFailed:this.lab_content.text="Your payment was unsuccessful, please try it later!",this.lab_content.textAlign=egret.HorizontalAlign.CENTER,this.lab_content.lineSpacing=15,this.img_title.source="Common_json.font_fail",this.im_image.source=""}},e.prototype.closeWindow=function(){UIManager.instance().closeWindow("ShoppinInfoWidget")},e}(UIWindow);__reflect(ShoppinInfoWidget.prototype,"ShoppinInfoWidget");var TimeButtonSkin=function(t){function e(){var e=t.call(this)||this;return e.MaxTime=.1,e.Pass=0,e.IsOK=!1,e.CallBack=null,e.skinName="resource/eui_skins/widgetSkins/TimeButtonSkin.exml",e}return __extends(e,t),e.prototype.createChildren=function(){this.InitProcess(),this.TimeGet(),this.startTime(this.MaxTime)},e.prototype.setCD=function(t){this.MaxTime=t},e.prototype.setImage=function(t){var e=this.Btn.getChildAt(0);e.source=RES.getRes(t)},e.prototype.setCallBack=function(t,e){this.CallBack=t},e.prototype.addTouchEvent=function(){this.Btn.touchEnabled=!0,this.Btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},e.prototype.startTime=function(t){this.MaxTime=t,this.Prog.visible=!0,this.TimeText.visible=!0,this.Pass=0,this.IsOK=!1,this.Timer=egret.setInterval(this.TimeGo,this,16.6666,16.6666)},e.prototype.TimeGo=function(t){this.TimeText.text=(this.MaxTime-this.Pass/1e3).toFixed(0).toString()+"s",this.Pass+=t;var e=this.Pass/1e3/this.MaxTime*360;e>360&&!this.IsOK&&this.TimeGet(),this.setProcess(e)},e.prototype.TimeGet=function(){this.IsOK=!0,this.Prog.visible=!1,this.TimeText.visible=!1,this.TimeText.text=(this.MaxTime-this.Pass/1e3).toFixed(0).toString()+"s",egret.clearInterval(this.Timer)},e.prototype.onTouch=function(t){console.info("onTouch"),this.IsOK&&(this.CallBack&&this.CallBack(),this.startTime(this.MaxTime))},e.prototype.InitProcess=function(){var t=this.Shape=new egret.Shape;this.Shape.touchEnabled=!0,t.x=this.width/2,t.y=this.width/2,this.addChild(t),this.Prog.mask=t},e.prototype.changeGraphics=function(t){function e(t){n.graphics.clear(),n.graphics.beginFill(65535,1),n.graphics.moveTo(0,0),n.graphics.lineTo(100,0),n.graphics.drawArc(0,0,100,0,t*Math.PI/180,!0),n.graphics.lineTo(0,0),n.graphics.endFill()}if(!(t>=360)||this.IsOK){var n=this.Shape;n.x=this.Prog.width/2,n.y=this.Prog.width/2,e(t)}},e.prototype.setProcess=function(t){this.changeGraphics(t)},e}(eui.Component);__reflect(TimeButtonSkin.prototype,"TimeButtonSkin");var TipTextBtnWidget=function(t){function e(){var e=t.call(this)||this;return e.effect=null,e.skinName="resource/eui_skins/widgetSkins/TipTextBtnWidget.exml",e}return __extends(e,t),e.prototype.onInit=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.effect=EffectManager.instance().createEffect("btn_flash","test1",-1),this.effectParent.x+=10,null!=this.effect&&this.effect.play(-1,this.effectParent)},e.prototype.setIcon=function(t){this.icon.source=t},e.prototype.setTop=function(t){this.topText.text=t},e.prototype.setBottom=function(t){this.bottomText.text=t},e.prototype.onRelease=function(){this.effect=null},e}(eui.Component);__reflect(TipTextBtnWidget.prototype,"TipTextBtnWidget",["UIWidget"]);var Dice=function(t){function e(){var e=t.call(this)||this;return e.seatid=-1,e.roll_call=null,e.skinName="resource/eui_skins/widgetSkins/DiceSkin.exml",e.Init(),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.Init=function(){this.hide()},e.prototype.setPosition=function(t){this.x=57+140*t-20,this.y=-147,this.seatid=t},e.prototype.show=function(t){this.visible=!0,t&&this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchDice,this),this.light.play(0)},e.prototype.hide=function(){this.visible=!1,this.removeTouch()},e.prototype.removeTouch=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchDice,this)},e.prototype.touchDice=function(){this.removeTouch(),GameManager.instance().rollStep(this.seatid)},e.prototype.playRoll=function(t,e){var n=this;this.removeTouch(),this.roll_1.removeEventListener("complete",this.roll_call,this),this.roll_call=function(){e(),n.hide()},this.seatid>=0&&(this.roll_1.addEventListener("complete",this.roll_call,this),this.roll_1.play(0))},e}(eui.Component);__reflect(Dice.prototype,"Dice");var GameMap=function(t){function e(){var e=t.call(this)||this;return e.layer_Zoder={min:0,snake:1,tree:2,ladder:3,max:4},e.tree_steps=new Array,e.players={},e.jumpArr=new Array,e.skinName="resource/eui_skins/widgetSkins/GameMapSkin.exml",e.Init(),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.Init=function(){for(var t=0;GameMapStepLen>t;t++)this.tree_steps.push(this["step_"+t])},e.prototype.addPlayerToMap=function(t){var e=new Player;this.g_map.addChildAt(e,this.layer_Zoder.ladder),this.players[t]=e,this.setStep(t,0),this.players[t].setImg("HeadIconTest_json.head"+(t+5))},e.prototype.setStep=function(t,e){this.players[t].x=this.getPosByStep(t,e).x,this.players[t].y=this.getPosByStep(t,e).y},e.prototype.moveToStep=function(t,e){var n=this.getPosByStep(t,e).x,o=this.getPosByStep(t,e).y,i=this;this.players[t].moveTo(n,o,function(){i.cashEvent(t,e),i.setPlayerZoder(t,e),i.doJumpWithArr()})},e.prototype.jumpToStep=function(t,e,n,o){var i=new Array;if(o>0){for(var r=n+o,a=n+2*o-e,s=a+1;r>=s;s++){var c=this.getPosByStep(t,s).x,p=this.getPosByStep(t,s).y;i.push({x:c,y:p})}for(var s=r-1;s>=n;s--){var c=this.getPosByStep(t,s).x,p=this.getPosByStep(t,s).y;i.push({x:c,y:p})}}else for(var a=n-e,s=a+1;n>=s;s++){var c=this.getPosByStep(t,s).x,p=this.getPosByStep(t,s).y;i.push({x:c,y:p})}var h=this;this.players[t].moveWithArr(i,function(){h.cashEvent(t,n),h.setPlayerZoder(t,n),h.doJumpWithArr()})},e.prototype.jumpWithArr=function(t,e,n){for(var o=0,i=n;o<i.length;o++){var r=i[o];r.seatid=t,r.rollnum=e}this.jumpArr=new Array,this.jumpArr=this.jumpArr.concat(n),this.doJumpWithArr()},e.prototype.doJumpWithArr=function(){Date.now();if(!(this.jumpArr.length<=0)){var t=this.jumpArr.shift();if(!t)return void this.doJumpWithArr();("ladder"==t.name||"snake"==t.name)&&this.moveToStep(t.seatid,t.step),"tree"==t.name&&this.jumpToStep(t.seatid,t.rollnum,t.step,t.out),"destination"==t.name}},e.prototype.setPlayerZoder=function(t,e){25==e?this.g_map.setChildIndex(this.players[t],this.layer_Zoder.tree):this.g_map.setChildIndex(this.players[t],this.g_map.numChildren-1)},e.prototype.getPosByStep=function(t,e){var n=this.tree_steps[e].x+(this.tree_steps[e].width-this.players[t].width)/2+-10+5*t,o=this.tree_steps[e].y-this.players[t].height+this.tree_steps[e].height/2;return{x:n,y:o}},e.prototype.cashEvent=function(t,e){if(GameDebug!=DebugType.OnLine&&GameMapEvents[e]){console.info("触碰到棋子事件",GameMapEvents[e]);var n=GameMapEvents[e].name;switch(n){case"start":break;case"tree":break;case"ladder":var o=GameMapEvents[e].toIndex;GameManager.instance().playEventStep(n,t,o);break;case"snake":var o=GameMapEvents[e].toIndex;GameManager.instance().playEventStep(n,t,o);break;case"destination":var o=GameMapEvents[e].toIndex;GameManager.instance().playerFinish(t)}}},e}(eui.Component);__reflect(GameMap.prototype,"GameMap");var GameMapEvent=[{index:0,event:{name:"start",toIndex:0},node:null},{index:1,event:{name:"tree",toIndex:0},node:null},{index:2,event:{name:"tree",toIndex:0},node:null},{index:3,event:{name:"tree",toIndex:0},node:null},{index:4,event:{name:"tree",toIndex:0},node:null},{index:5,event:{name:"tree",toIndex:0},node:null},{index:6,event:{name:"tree",toIndex:0},node:null},{index:7,event:{name:"ladder",toIndex:19},node:null},{index:8,event:{name:"tree",toIndex:0},node:null},{index:9,event:{name:"tree",toIndex:0},node:null},{index:10,event:{name:"tree",toIndex:0},node:null},{index:11,event:{name:"tree",toIndex:0},node:null},{index:12,event:{name:"tree",toIndex:0},node:null},{index:13,event:{name:"tree",toIndex:0},node:null},{index:14,event:{name:"tree",toIndex:0},node:null},{index:15,event:{name:"tree",toIndex:0},node:null},{index:16,event:{name:"tree",toIndex:0},node:null},{index:17,event:{name:"ladder",toIndex:29},node:null},{index:18,event:{name:"tree",toIndex:0},node:null},{index:19,event:{name:"tree",toIndex:0},node:null},{index:20,event:{name:"snake",toIndex:1},node:null},{index:21,event:{name:"tree",toIndex:0},node:null},{index:22,event:{name:"tree",toIndex:0},node:null},{index:23,event:{name:"tree",toIndex:0},node:null},{index:24,event:{name:"ladder",toIndex:41},node:null},{index:25,event:{name:"tree",toIndex:0},node:null},{index:26,event:{name:"tree",toIndex:0},node:null},{index:27,event:{name:"ladder",toIndex:38},node:null},{index:28,event:{name:"tree",toIndex:0},node:null},{index:29,event:{name:"tree",toIndex:0},node:null},{index:30,event:{name:"snake",toIndex:12},node:null},{index:31,event:{name:"tree",toIndex:0},node:null},{index:32,event:{name:"tree",toIndex:0},node:null},{index:33,event:{name:"tree",toIndex:0},node:null},{index:34,event:{name:"tree",toIndex:0},node:null},{index:35,event:{name:"tree",toIndex:0},node:null},{index:36,event:{name:"snake",toIndex:19},node:null},{index:37,event:{name:"tree",toIndex:0},node:null},{index:38,event:{name:"tree",toIndex:0},node:null},{index:39,event:{name:"tree",toIndex:0},node:null},{index:40,event:{name:"tree",toIndex:0},node:null},{index:41,event:{name:"tree",toIndex:0},node:null},{index:42,event:{name:"tree",toIndex:0},node:null},{index:43,event:{name:"tree",toIndex:0},node:null},{index:44,event:{name:"tree",toIndex:0},node:null},{index:45,event:{name:"tree",toIndex:0},node:null},{index:46,event:{name:"snake",toIndex:25},node:null},{index:47,event:{name:"destination",toIndex:0},node:null}],Player=function(t){function e(){var e=t.call(this)||this;return e.pre_prop={x:0,y:0},e.to_prop={x:0,y:0},e.skinName="resource/eui_skins/widgetSkins/PlayerSkin.exml",e.Init(),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setImg=function(t){this.img_me.source=RES.getRes(t),this.img_me.smoothing=!0},e.prototype.Init=function(){this.setPreProp()},e.prototype.setPreProp=function(){this.pre_prop.x=this.x,this.pre_prop.y=this.y},e.prototype.setToProp=function(t,e){this.to_prop.x=t,this.to_prop.y=e},e.prototype.moveWithArr=function(t,e){var n=this,o=1200/t.length;o=o>200?200:o;var i=0;clearInterval(n.move_timer),this.move_timer=setInterval(function(){i<t.length?n.move(t[i].x,t[i].y,o):(e(),clearInterval(n.move_timer)),i++},o)},e.prototype.move=function(t,e,n){this.setPreProp(),this.setToProp(t,e);var o=this;egret.Tween.removeTweens(o),egret.Tween.get(this).to({factor:1},n)},e.prototype.moveTo=function(t,e,n){this.setPreProp(),this.setToProp(t,e);var o=this;egret.Tween.removeTweens(o),egret.Tween.get(this).to({factor:1},1e3).call(n,this)},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){var e=Math.sqrt(Math.pow(this.to_prop.x-this.pre_prop.x,2)+Math.pow(this.to_prop.y-this.pre_prop.y,2)),n=(this.to_prop.x+this.pre_prop.x)/2,o=(this.to_prop.y+this.pre_prop.y)/2-.3*e;this.x=(1-t)*(1-t)*this.pre_prop.x+2*t*(1-t)*n+t*t*this.to_prop.x,this.y=(1-t)*(1-t)*this.pre_prop.y+2*t*(1-t)*o+t*t*this.to_prop.y},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(Player.prototype,"Player");var ChatWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/ChatSkin.exml",this.registerEvent(),this.initData()},e.prototype.registerEvent=function(){var t=this;this.chatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChatBtn,this),Utils.getInstance().buttonEffect(this.sendImg,this.send,this),EventManager.instance().addEventListener(GameEvents.DISPATCH_CHAT_MESSAGE,function(e){t.textInput.text=e,t.bg.visible=!1,t.srcListText.visible=!1},this)},e.prototype.send=function(){""!=this.textInput.text&&(console.log("发送文字消息",this.textInput.text),GameNetwork.Instance.reqChat(this.textInput.text),UIManager.instance().closeWindow("ChatWindow"))},e.prototype.onChatBtn=function(t){this.srcListText.visible=!0,this.bg.visible=!0},e.prototype.initData=function(){var t=[{text:"You are so pretty"},{text:"Charming eyes"},{text:"Mad about you"},{text:"Singe ich mein lied"}];this.listText.dataProvider=new eui.ArrayCollection(t),this.listText.itemRenderer=ChatText;var e=[{icon:"Emojis_json.emojis_01"},{icon:"Emojis_json.emojis_02"},{icon:"Emojis_json.emojis_03"},{icon:"Emojis_json.emojis_04"},{icon:"Emojis_json.emojis_04"},{icon:"Emojis_json.emojis_04"},{icon:"Emojis_json.emojis_04"},{icon:"Emojis_json.emojis_04"},{icon:"Emojis_json.emojis_04"},{icon:"Emojis_json.emojis_04"}];this.listImg.dataProvider=new eui.ArrayCollection(e),this.listImg.itemRenderer=ListImgIRSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.closeMainUI=function(){null!=this.parent&&this.parent.removeChild(this)},e}(UIWindow);__reflect(ChatWindow.prototype,"ChatWindow");var ListImgIRSkin=function(t){function e(){var e=t.call(this)||this;return e.skinName="SigleSkin",e.width=82,e.height=82,e.playerSkin.width=82,e.playerSkin.height=82,e.playerSkin.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){UIManager.instance().closeWindow("ChatWindow"),GameNetwork.Instance.reqChat("[f:"+e.playerSkin.source+"]"),console.log("发送表情"+e.playerSkin.source)},e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.ItemRenderer);__reflect(ListImgIRSkin.prototype,"ListImgIRSkin");var ChatText=function(t){function e(){var e=t.call(this)||this;return e.skinName="LabelSkin",e.text.addEventListener(egret.TouchEvent.TOUCH_END,function(){EventManager.instance().dispatchEvent(GameEvents.DISPATCH_CHAT_MESSAGE,e.text.text)},e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.ItemRenderer);__reflect(ChatText.prototype,"ChatText");var FriendRankWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/RankingSkin.exml"},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initRank()},e.prototype.initRank=function(){var t=[],t=[{bg:"Common_json.frame_09",rank:"1",icon:"Common_json.icon_apple",name:"nick1",won:"10",rankImg:"Common_json.halo_01"},{rank:"2",icon:"Common_json.icon_apple",name:"nick1",won:"10",bg:"Common_json.frame_11",rankImg:"Common_json.halo_02"},{rank:"3",icon:"Common_json.icon_apple",name:"nick1",won:"10",bg:"Common_json.frame_09",rankImg:"Common_json.halo_02"},{rank:"4",icon:"Common_json.icon_apple",name:"nick",won:"10",bg:"Common_json.frame_11"},{rank:"5",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"6",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"7",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"8",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"9",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"10",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"11",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"12",icon:"Common_json.icon_apple",name:"nick",won:"10"}];this.itemList.dataProvider=new eui.ArrayCollection(t),this.itemList.itemRenderer=ItemListIRSkin},e.prototype.closeMainUI=function(){null!=this.parent&&this.parent.removeChild(this)},e}(UIWindow);__reflect(FriendRankWindow.prototype,"FriendRankWindow");var ItemListIRSkin=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankItem",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.ItemRenderer);__reflect(ItemListIRSkin.prototype,"ItemListIRSkin");var GameEndWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/GameEndSkin.exml",this.registerBtnEvent(),this.initWindow()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.initWindow=function(){this.back.setImgScore("Common_json.button_blue_l"),this.back.getLabel().text="Start",this.back.getLabel().size=30,this.next.setImgScore("Common_json.button_green_l"),this.next.getLabel().text="Invite more",this.next.getLabel().size=30},e.prototype.registerBtnEvent=function(){this.back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchBackBtn,this),this.next.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchNextBtn,this)},e.prototype.touchBackBtn=function(){this.closeMe()},e.prototype.touchNextBtn=function(){},e.prototype.closeMe=function(){GameManager.instance().endGame(),this.close()},e.prototype.release=function(){},e}(UIWindow);__reflect(GameEndWindow.prototype,"GameEndWindow");var GameEnterWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/GameEnterSkin.exml",this.registerBtnEvent(),this.initWindow()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.initWindow=function(){this.start_1.getLabel().text="Play now",this.start_2.getLabel().text="with Friends",this.start_3.getLabel().text="Training"},e.prototype.registerBtnEvent=function(){this.start_1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickEnterGame1,this),this.start_2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickEnterGame2,this),this.start_3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickEnterGame3,this)},e.prototype.clickEnterGame1=function(t){GameManager.instance().enterGame(GameType.matchingMode)
},e.prototype.clickEnterGame2=function(t){GameManager.instance().enterGame(GameType.firendMode)},e.prototype.clickEnterGame3=function(t){GameManager.instance().enterGame(GameType.normalMode)},e.prototype.release=function(){},e}(UIWindow);__reflect(GameEnterWindow.prototype,"GameEnterWindow");var GameWindow=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.operations={},e}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/GameSkin.exml",this.registerBtnEvent(),this.initWindow()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),UIManager.instance().openWindow("GropRewardWindow")},e.prototype.initWindow=function(){this.player_list.dataProvider=new eui.ArrayCollection,this.player_list.itemRenderer=HeadIconWidget},e.prototype.playerEnter=function(t,e){var n=this,o=this.player_list.dataProvider;o.addItem({scale_img:.76,headType:HeadIconType.headIcon,playerInfo:e,seatid:t,event:function(t){n.touchPlayer(t.seatid,t.playerInfo)}});var i=o.getItemIndex(o.length-1);o.itemUpdated(i),t==GameManager.instance().gameLogic.getMySeatId(),this.map.addPlayerToMap(t)},e.prototype.showOperationBD=function(t,e){if(this.operations[t])this.operations[t].show(e);else{var n=new Dice;this.players_group.addChild(n),this.operations[t]=n,this.operations[t].setPosition(t),n.show(e)}},e.prototype.hideOperationBD=function(t){this.operations[t]&&this.operations[t].removeTouch()},e.prototype.touchPlayer=function(t,e){if(console.info("touch player:",t,e.nickName),UserManager.instance().setCurPlayerInfo(e),t==GameManager.instance().gameLogic.getMySeatId()){null!=this.currentInfo&&UIManager.instance().closeWindow(this.currentInfo);UIManager.instance().openWindow("ChatWindow");this.currentInfo="ChatWindow"}else{null!=this.currentInfo&&UIManager.instance().closeWindow(this.currentInfo);UIManager.instance().openWindow("RoleHeadInfoWindow");this.currentInfo="RoleHeadInfoWindow"}},e.prototype.playStart=function(){},e.prototype.playRollFirst=function(t,e){this.showOperationBD(t,!1),this.operations[t].playRoll(e,function(){})},e.prototype.playRoll=function(t,e,n,o){var i=this;this.operations[t].playRoll(e,function(){i.map.jumpToStep(t,e,n,o)})},e.prototype.playMoveArr=function(t,e,n){var o=this;this.operations[t]?this.operations[t].playRoll(e,function(){o.map.jumpWithArr(t,e,n)}):o.map.jumpWithArr(t,e,n)},e.prototype.showChatMsg=function(t,e){if(console.info("玩家：",t," 发送聊天内容：",e),UIManager.instance().findWindow("ShowChatWindow")){var n=UIManager.instance().findWindow("ShowChatWindow");n.showChat(t,e)}else{var o=UIManager.instance().openWindow("ShowChatWindow");o.showChat(t,e)}},e.prototype.showChatFace=function(t,e){if(console.info("玩家：",t," 发送表情聊天资源：",e),UIManager.instance().findWindow("ShowChatWindow")){var n=UIManager.instance().findWindow("ShowChatWindow");n.showEmojis(t,e)}else{var o=UIManager.instance().openWindow("ShowChatWindow");o.showEmojis(t,e)}},e.prototype.registerBtnEvent=function(){this.setting_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickToSettingBtn,this)},e.prototype.clickToSettingBtn=function(){UIManager.instance().openWindow("SettingWindow")},e.prototype.clickShowRewardBtn=function(){},e.prototype.clickBackBtn=function(t){GameManager.instance().endGame()},e.prototype.release=function(){},e}(UIWindow);__reflect(GameWindow.prototype,"GameWindow");var GobalRankWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/RankingSkin.exml"},e.prototype.initRank=function(){var t=[{bg:"Common_json.frame_09",rank:"1",icon:"Common_json.icon_apple",name:"nick",won:"10",rankImg:"Common_json.halo_01"},{rank:"2",icon:"Common_json.icon_apple",name:"nick",won:"10",bg:"Common_json.frame_11",rankImg:"Common_json.halo_02"},{rank:"3",icon:"Common_json.icon_apple",name:"nick",won:"10",bg:"Common_json.frame_09",rankImg:"Common_json.halo_02"},{rank:"4",icon:"Common_json.icon_apple",name:"nick",won:"10",bg:"Common_json.frame_11"},{rank:"5",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"6",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"7",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"8",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"9",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"10",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"11",icon:"Common_json.icon_apple",name:"nick",won:"10"},{rank:"12",icon:"Common_json.icon_apple",name:"nick",won:"10"}];this.itemList.dataProvider=new eui.ArrayCollection(t),this.itemList.itemRenderer=ItemListIRSkin},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initRank()},e.prototype.closeMainUI=function(){null!=this.parent&&this.parent.removeChild(this)},e}(UIWindow);__reflect(GobalRankWindow.prototype,"GobalRankWindow");var GropRewardWindow=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShowReward=!0,e}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/GropReward.exml",EventManager.instance().addEventListener(GameEvents.ShowReward,this.clickShowRewardBtn,this),this.btn_drop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShowRewardBtn,this),this.lab_reward1.text="2000",this.lab_reward2.text="1000",this.lab_reward3.text="500",this.lab_reward4.text="250"},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),console.log("createChildren")},e.prototype.clickToSettingBtn=function(){UIManager.instance().openWindow("SettingWindow")},e.prototype.clickShowRewardBtn=function(t){var e=this;if(this.isShowReward){this.isShowReward=null,this.gro_reward.visible=!0,this.re_rect.visible=!0,this.gro_list.mask=this.re_rect;egret.Tween.get(this.gro_list).to({y:this.gro_list.y+this.gro_list.height},500).call(function(){e.isShowReward=!1})}else if(0==this.isShowReward){this.isShowReward=null,this.gro_reward.visible=!0;egret.Tween.get(this.gro_list).to({y:this.gro_list.y-this.gro_list.height},500).call(function(){e.isShowReward=!0,e.gro_reward.visible=!1})}},e}(UIWindow);__reflect(GropRewardWindow.prototype,"GropRewardWindow");var LoadingWindow=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.w=0,e.h=0,e}return __extends(e,t),e.prototype.onInit=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.createView,this)},e.prototype.createView=function(){this.w=egret.MainContext.instance.stage.stageWidth,this.h=egret.MainContext.instance.stage.stageHeight,this.Bg=new egret.Bitmap,Util.setAnchorMiddle(this.Bg),this.Bg.texture=RES.getRes("bg_03_png"),this.Bg.width=this.w,this.Bg.height=this.h,this.addChild(this.Bg),this.text1=new egret.TextField,this.addChild(this.text1),this.text1.width=.5*this.w,this.text1.height=18,this.setAnchorMiddle(this.text1),this.text1.x=this.w/2,this.text1.y=this.h-220,this.text1.textAlign="center",this.text1.size=18,this.text1.textColor=16777215,this.text1.fontFamily="Microsoft YaHei",this.text1.text="首次加载时间较长，请耐心等待",this.text2=new egret.TextField,this.text2.width=.5*this.w,this.text2.height=15,this.setAnchorMiddle(this.text2),this.text2.fontFamily="Microsoft YaHei",this.text2.textAlign="center",this.text2.size=14,this.text2.textFlow=new Array({text:"无法进入游戏请",style:{textColor:16777215}},{text:"刷新",style:{href:"event:text event triggered",textColor:16748634,underline:!0}},{text:"正在下载sdk",style:{textColor:16777215}}),this.text2.touchEnabled=!0,this.text2.addEventListener(egret.TextEvent.LINK,this.referesh,this),this.addChild(this.text2),this.text2.x=this.text1.x,this.text2.y=this.text1.y+28,this.progressBg=new egret.Bitmap,this.progressBg.texture=RES.getRes("bar_jiazai_01_png"),this.progressBg.scale9Grid=new egret.Rectangle(2,2,6,5),this.progressBg.width=.8*this.w,this.progressBg.height=9,this.setAnchorMiddle(this.progressBg),this.progressBg.x=this.w/2,this.progressBg.y=this.text2.y+28,this.addChild(this.progressBg),this.progressFront=new egret.Bitmap,this.progressFront.texture=RES.getRes("bar_jiazai_02_png"),this.progressFront.scale9Grid=new egret.Rectangle(2,2,6,5),this.progressFront.width=.8*this.w,this.progressFront.height=9,this.setAnchorMiddle(this.progressFront),this.progressFront.x=this.progressBg.x,this.progressFront.y=this.progressBg.y,this.addChild(this.progressFront),this.warnText=new egret.TextField,this.warnText.width=.8*this.w,this.warnText.height=39,this.setAnchorMiddle(this.warnText),this.warnText.text="抵 制 不 良 游 戏   拒 绝 盗 版 游 戏   注 意 自 我 保 护   谨 防 上 当 受 骗\n适 度 游 戏 益 脑   沉 默 游 戏 伤 身   合 理 安 排 时 间   享 受 健 康 生 活",this.warnText.lineSpacing=10,this.warnText.textColor=8686230,this.warnText.size=14,this.warnText.textAlign="center",this.warnText.x=this.w/2,this.warnText.y=this.progressFront.y+35,this.addChild(this.warnText),this.bottom1=new egret.TextField,this.bottom1.width=.8*this.w,this.bottom1.height=15,this.setAnchorMiddle(this.bottom1),this.bottom1.text="网络游戏初版物号（ISBN） ISBN 978-7-7979-3652-0",this.bottom1.lineSpacing=10,this.bottom1.textColor=8686230,this.bottom1.size=14,this.bottom1.textAlign="center",this.bottom1.x=this.w/2,this.bottom1.y=this.warnText.y+40,this.addChild(this.bottom1),this.bottom2=new egret.TextField,this.bottom2.width=.8*this.w,this.bottom2.height=15,this.setAnchorMiddle(this.bottom2),this.bottom2.text="本应用由’武汉小脑斧信息科技有限公司’提供",this.bottom2.lineSpacing=10,this.bottom2.textColor=8686230,this.bottom2.size=14,this.bottom2.textAlign="center",this.bottom2.x=this.w/2,this.bottom2.y=this.bottom1.y+27,this.addChild(this.bottom2)},e.prototype.onProgress=function(t,e){var n=t/e;if(.9>n?this.setProgress(n):this.setProgress(.9),n>.999999){var o=new egret.Timer(50,1);o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),o.start()}},e.prototype.referesh=function(t){console.log("referesh")},e.prototype.setProgress=function(t){t>1?t=1:0>t&&(t=0),platform.setLoadingProgress(t),this.frontMask=new egret.Rectangle(0,0,this.progressFront.width*t,this.progressFront.height),this.progressFront.mask=this.frontMask},e.prototype.setAnchorMiddle=function(t){t.$anchorOffsetX=t.width/2,t.$anchorOffsetY=t.height/2},e.prototype.timerComFunc=function(){this.setProgress(1)},e}(UIWindow);__reflect(LoadingWindow.prototype,"LoadingWindow",["RES.PromiseTaskReporter"]);var LoginWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/LoginUISkin.exml",this.registerBtnEvent(),console.log("into ")},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),console.log("createChildren")},e.prototype.registerBtnEvent=function(){this.enter_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickEnterGame,this)},e.prototype.initWindow=function(){this.tip.lineSpacing=5},e.prototype.clickEnterGame=function(t){UIManager.instance().closeWindow("LoginWindow"),UIManager.instance().openWindow("MainWindow")},e}(UIWindow);__reflect(LoginWindow.prototype,"LoginWindow");var MainWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/MainSkin.exml",this.registerBtnEvent(),this.initWindow()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),UIManager.instance().openWindow("RankWindow"),UIManager.instance().openWindow("RoleTopInfoWidget"),UIManager.instance().openWindow("GameEnterWindow")},e.prototype.initWindow=function(){console.info(UserManager.instance().getUserInfo())},e.prototype.updateInfo=function(){},e.prototype.registerBtnEvent=function(){},e.prototype.clickEnterSetting=function(t){console.log("打开游戏设置界面"),UIManager.instance().openWindow("SettingWindow")},e.prototype.closeMainUI=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.release=function(){},e}(UIWindow);__reflect(MainWindow.prototype,"MainWindow");var MatchingWindow=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.matchListDate=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/MatchingSkin.exml",this.registerBtnEvent(),this.initWindow()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.initWindow=function(){this.start.setImgScore("Common_json.button_blue_l"),this.start.getLabel().text="Start",this.start.getLabel().size=30,this.invite.setImgScore("Common_json.button_green_l"),this.invite.getLabel().text="Invite more",this.invite.getLabel().size=30,this.close_bn.setImgScore("Common_json.icon_x"),this.match_list.dataProvider=new eui.ArrayCollection,this.match_list.itemRenderer=HeadIconWidget,this.start.visible=!1,this.invite.visible=!1,GameManager.instance().type==GameType.normalMode||GameManager.instance().type==GameType.matchingMode||GameManager.instance().type==GameType.firendMode&&(this.start.visible=!0,this.invite.visible=!0)},e.prototype.playerEnter=function(t,e){var n=this.match_list.dataProvider;n.addItem({scale:1,playerInfo:e});var o=n.getItemIndex(n.length-1);n.itemUpdated(o)},e.prototype.registerBtnEvent=function(){this.close_bn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeMe,this),this.start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchStartBtn,this),this.invite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchInviteBtn,this)},e.prototype.touchStartBtn=function(){return console.info("touchStartBtn"),GameManager.instance().gameLogic.roomInfo.players.length>=2?void GameNetwork.Instance.reqStartGame():void 0},e.prototype.touchShareInviteBtn=function(){console.info("touchInviteBtn");var t=Util.getBase64Image("map_01_png");platform.share({intent:"INVITE",title:UserManager.instance().getPlayerInfo().nickName+"邀请你来玩了！",imgurl:t,data:{inviteRomeId:GameManager.instance().gameLogic.roomInfo.roomID},complete:function(){}})},e.prototype.touchInviteBtn=function(){console.info("touchInviteBtn");var t=this;platform.chooseAsync({fail:function(t){console.error(t)},success:function(){platform.getContext().then(function(t){console.info("切换环境成功:",t.getID(),t.getType(),t.getPlayersAsync())}),t.updateGame()}})},e.prototype.updateGame=function(){var t=Util.getBase64Image("map_01_png");platform.updateAsync({payload:{action:"CUSTOM",template:"join_room",cta:{"default":"Play with me",localizations:{zh_CN:"和我一起玩吧"}},image:t,text:{"default":"Welcom to play",localizations:{zh_CN:"欢迎欢迎"}},data:{inviteRomeId:GameManager.instance().gameLogic.roomInfo.roomID},strategy:"IMMEDIATE_CLEAR",notification:"NO_PUSH"},success:function(){console.info("更新完成，控制权还给游戏")},fail:function(t){console.error(t)}})},e.prototype.closeMe=function(){GameManager.instance().endGame(),this.close()},e.prototype.release=function(){},e}(UIWindow);__reflect(MatchingWindow.prototype,"MatchingWindow");var MatchTipWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/MatchTipSkin.exml",this.registerBtnEvent()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.registerBtnEvent=function(){Utils.getInstance().buttonEffect(this.determine,this.onDetermine,this),Utils.getInstance().buttonEffect(this.back,this.onBack,this),Utils.getInstance().buttonEffect(this.quit,this.onBack,this)},e.prototype.onDetermine=function(t){GameManager.instance().endGame()},e.prototype.onBack=function(t){this.closeMainUI()},e.prototype.closeMainUI=function(){UIManager.instance().closeWindow("MatchTipWindow")},e}(UIWindow);__reflect(MatchTipWindow.prototype,"MatchTipWindow");var RankWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/RankSkin.exml",Utils.getInstance().buttonEffect(this.friendBtn,this.friendRankHandler,this,this.friendText),Utils.getInstance().buttonEffect(this.gobalBtn,this.gobalRankHandler,this,this.globalText)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),UIManager.instance().openWindow("GobalRankWindow")},e.prototype.gobalRankHandler=function(t){UIManager.instance().openWindow("GobalRankWindow"),UIManager.instance().closeWindow("FriendRankWindow")},e.prototype.friendRankHandler=function(t){UIManager.instance().openWindow("FriendRankWindow"),UIManager.instance().closeWindow("GobalRankWindow")},e}(UIWindow);__reflect(RankWindow.prototype,"RankWindow");var RoleHeadInfoWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/RoleHeadInfoSkin.exml",this.registerBtnEvent(),this.initWindow()},e.prototype.initWindow=function(){this.playerInfo=UserManager.instance().getCurPlayerInfo(),this.lab_total.text=this.playerInfo.gameTotalCount.toString(),this.lab_one.text=this.playerInfo.getFirstCount.toString();this.head_icon.setNameVisiable(!0),this.head_icon.data={playerInfo:this.playerInfo}},e.prototype.registerBtnEvent=function(){this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeRoleHeadInfo,this),this.btn_close.setImgScore("Common_json.icon_x")},e.prototype.closeRoleHeadInfo=function(){console.log("关闭界面"),UIManager.instance().closeWindow("RoleHeadInfoWindow")},e}(UIWindow);__reflect(RoleHeadInfoWindow.prototype,"RoleHeadInfoWindow");var SelectSkinWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/SelectSkin.exml",this.playerInfo=UserManager.instance().getPlayerInfo(),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btn_exit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickExit,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickShare,this);var e="data_name",n="data_value";egret.localStorage.setItem(e,n);for(var o=(egret.localStorage.getItem(e),new eui.ArrayCollection),i=this.playerInfo.myScans.length,r=0;i>r;r++){var a=this.playerInfo.myScans[r];o.addItem({playerInfo:this.playerInfo,headType:HeadIconType.gameIconOne,headIconIndex:a})}this.listPlayers.dataProvider=o,this.listPlayers.itemRenderer=HeadIconWidget;this.head_icon.setNameVisiable(!0),this.head_icon.headType=HeadIconType.gameIcon,this.head_icon.data={playerInfo:this.playerInfo}},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onClickClose=function(){UIManager.instance().closeWindow("SelectSkinWindow")},e.prototype.onClickExit=function(){console.log("退出游戏！")},e.prototype.onClickShare=function(){console.log("分享游戏！")},e.prototype.closeMainUI=function(){null!=this.parent&&this.parent.removeChild(this)},e}(UIWindow);__reflect(SelectSkinWindow.prototype,"SelectSkinWindow");var SettingWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/SettingSkin.exml",this.playerInfo=UserManager.instance().getPlayerInfo(),this.playerImg.source=ConfigInfo.myScansHasMap.getValue(this.playerInfo.selectScan),this.registerBtnEvent(),this.InitData()},e.prototype.InitData=function(){MusicManager.getInstance().isMuteMusic?(this.musicOnImg.visible=!1,this.musicOffImg.visible=!0,this.musicImg.source="Common_json.icon_music1"):(this.musicOnImg.visible=!0,this.musicOffImg.visible=!1,this.musicImg.source="Common_json.icon_music"),MusicManager.getInstance().isMuteEffect?(this.effectOnImg.visible=!1,this.effectOffImg.visible=!0,this.effectImg.source="Common_json.icon_sound1"):(this.effectOnImg.visible=!0,this.effectOffImg.visible=!1,this.effectImg.source="Common_json.iconsound"),null!=UIManager.instance().findWindow("GameWindow")?(this.quitRoom.visible=!0,this.quitBtn.visible=!1,this.shareBtn.visible=!1):(this.quitRoom.visible=!1,this.quitBtn.visible=!0,this.shareBtn.visible=!0)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.registerBtnEvent=function(){var t=this;this.playerImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeImg,this),this.musicBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMusicClick,this),this.effectBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEffectClick,this),Utils.getInstance().buttonEffect(this.shareBtn,this.onShare,this),Utils.getInstance().buttonEffect(this.quitBtn,this.onQuit,this),Utils.getInstance().buttonEffect(this.closeBtn,this.onClose,this),Utils.getInstance().buttonEffect(this.quitRoom,this.QuitRoom,this),EventManager.instance().addEventListener(GameEvents.CHANGE_PLAYER_SKIN,function(e){t.playerImg.source=ConfigInfo.myScansHasMap.getValue(e),t.playerInfo.selectScan=e,UIManager.instance().closeWindow("SelectSkinWindow"),GameNetwork.Instance.requestUpdatePlayerData()},this)},e.prototype.QuitRoom=function(){UIManager.instance().openWindow("MatchTipWindow")},e.prototype.onClose=function(t){UIManager.instance().closeWindow("SelectSkinWindow"),this.closeMainUI()},e.prototype.onShare=function(t){},e.prototype.onQuit=function(t){UIManager.instance().findWindow("MainWindow")?UIManager.instance().openWindow("UnMatchTipWindow"):UIManager.instance().openWindow("MatchTipWindow")},e.prototype.onChangeImg=function(t){UIManager.instance().openWindow("SelectSkinWindow")},e.prototype.onMusicClick=function(){MusicManager.getInstance().isMuteMusic=!MusicManager.getInstance().isMuteMusic,MusicManager.getInstance().isMuteMusic?(MusicManager.getInstance().MuteMusic(),this.musicOnImg.visible=!1,this.musicOffImg.visible=!0,this.musicImg.source="Common_json.icon_music1"):(MusicManager.getInstance().RestoreMusic(),this.musicOnImg.visible=!0,this.musicOffImg.visible=!1,this.musicImg.source="Common_json.icon_music")},e.prototype.onEffectClick=function(){MusicManager.getInstance().isMuteEffect=!MusicManager.getInstance().isMuteEffect,MusicManager.getInstance().isMuteEffect?(MusicManager.getInstance().MuteEffect(),this.effectOffImg.visible=!0,this.effectOnImg.visible=!1,this.effectImg.source="Common_json.icon_sound1"):(MusicManager.getInstance().RestoreMuteEffect(),this.effectOffImg.visible=!1,this.effectOnImg.visible=!0,this.effectImg.source="Common_json.iconsound")},e.prototype.closeMainUI=function(){UIManager.instance().closeWindow("SettingWindow")},e.prototype.release=function(){},e}(UIWindow);__reflect(SettingWindow.prototype,"SettingWindow");var ShopWindow=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curShopBagType=null,e}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),UIManager.instance().openWindow("RoleTopInfoWidget"),this.skinName="resource/eui_skins/windowSkins/ShopSkin.exml",this.registerBtnEvent(),this.curShopBagType=ShopBagType.emojis,ShopManager.instance().curShopBagType=this.curShopBagType,this.initWindow()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.initWindow=function(){console.info(UserManager.instance().getUserInfo()),this.emojis_btn.getLabel().text="Emojis",this.emojis_btn.setImgScore("Common_json.button_green_l"),this.gameGold_btn.getLabel().text="Apples",this.gameGold_btn.setImgScore("Common_json.button_blue_l"),this.close_btn.setImgScore("Common_json.icon_x"),this.initShopItemList()},e.prototype.registerBtnEvent=function(){this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeShopUI,this),this.emojis_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClickToEmojis,this),this.gameGold_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnClickToGameGold,this)},e.prototype.OnClickToEmojis=function(){this.curShopBagType=ShopBagType.emojis,ShopManager.instance().curShopBagType=this.curShopBagType,this.shop_Scroller.stopAnimation(),this.showShopItemByType()},e.prototype.OnClickToGameGold=function(){this.curShopBagType=ShopBagType.gold,ShopManager.instance().curShopBagType=this.curShopBagType,this.shop_Scroller.stopAnimation(),this.showShopItemByType()},e.prototype.clickEnterSetting=function(t){console.log("打开游戏设置界面"),UIManager.instance().openWindow("SettingWindow")},e.prototype.clickEnterShop=function(t){console.log("打开商店")},e.prototype.closeShopUI=function(){UIManager.instance().closeWindow("ShoppinInfoWidget"),UIManager.instance().closeWindow("ShopWindow"),UIManager.instance().openWindow("MainWindow")},e.prototype.initShopItemList=function(){this.showShopItemByType()},e.prototype.valueChange=function(){console.log("valueChange")},e.prototype.showShopItemByType=function(){var t=[];switch(t=ShopManager.instance().getShopBagByType(this.curShopBagType).values(),ShopManager.instance().shoppingItemInfo.shopdataArr=t,this.curShopBagType){case ShopBagType.emojis:case ShopBagType.piece:var e=new eui.ArrayCollection(t);this.shopItmeList.dataProvider=e,this.shopItmeList.itemRenderer=ShopItemList,this.shopItmeList.validateNow();break;case ShopBagType.gold:var n=new eui.ArrayCollection(t);this.shopItmeList.dataProvider=n,this.shopItmeList.itemRenderer=ShopItemGold,this.shopItmeList.validateNow()}},e.prototype.release=function(){},e}(UIWindow);__reflect(ShopWindow.prototype,"ShopWindow");var ShowChatWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/ShowChatSkin.exml",this.registerEvent()},e.prototype.registerEvent=function(){},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.time=new egret.Timer(3e3,1),this.arr=[[this.emojis_group0,this.emojis0,this.emojis_group4,this.chat0],[this.emojis_group1,this.emojis1,this.emojis_group5,this.chat1],[this.emojis_group2,this.emojis2,this.emojis_group6,this.chat2],[this.emojis_group3,this.emojis3,this.emojis_group7,this.chat3]]},e.prototype.closeMainUI=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.showEmojis=function(t,e){var n=this;null!=this.current&&(this.current.visible=!1),this.arr[t][0].visible=!0,this.arr[t][1].source=e,this.current=this.arr[t][0],this.time.start(),this.time.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){n.arr[t][0].visible=!1,n.time.stop(),n.current=null},this)},e.prototype.showChat=function(t,e){var n=this;null!=this.current&&(this.current.visible=!1),this.arr[t][2].visible=!0,this.arr[t][3].text=e,this.current=this.arr[t][2],this.time.start(),this.time.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){n.arr[t][2].visible=!1,n.current=null,n.time.stop()},this)},e}(UIWindow);__reflect(ShowChatWindow.prototype,"ShowChatWindow");var UnMatchTipWindow=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onInit=function(){t.prototype.onInit.call(this),this.skinName="resource/eui_skins/windowSkins/UnMatchTipSkin.exml",this.registerBtnEvent()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.registerBtnEvent=function(){Utils.getInstance().buttonEffect(this.determine,this.onDetermine,this),Utils.getInstance().buttonEffect(this.back,this.onBack,this),Utils.getInstance().buttonEffect(this.quit,this.onBack,this)},e.prototype.onDetermine=function(t){platform.quit()},e.prototype.onBack=function(t){this.closeMainUI()},e.prototype.closeMainUI=function(){UIManager.instance().closeWindow("UnMatchTipWindow")},e}(UIWindow);__reflect(UnMatchTipWindow.prototype,"UnMatchTipWindow");